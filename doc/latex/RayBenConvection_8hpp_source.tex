\hypertarget{RayBenConvection_8hpp_source}{}\doxysection{Ray\+Ben\+Convection.\+hpp}
\label{RayBenConvection_8hpp_source}\index{src/RayBenConvection.hpp@{src/RayBenConvection.hpp}}

\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{/******************************************************************}}
\DoxyCodeLine{2 \textcolor{comment}{ * TODO list:}}
\DoxyCodeLine{3 \textcolor{comment}{ * X -\/ Metodi privati vanno rinominati con il prefisso m\_}}
\DoxyCodeLine{4 \textcolor{comment}{ * 2 -\/ Dopo aver scritto la documentazione sulla matematica: m\_ii, m\_jj -\/> nx-\/2, ny-\/2}}
\DoxyCodeLine{5 \textcolor{comment}{ * X -\/ write\_current\_frame() deve scrivere un file .h che conterra' una}}
\DoxyCodeLine{6 \textcolor{comment}{ *     dichiarazione di una variabile globale dal nome poco rilevante che sara' }}
\DoxyCodeLine{7 \textcolor{comment}{ *     del tipo double[nx][ny][5000] ad ogni chiamata del metodo in oggetto}}
\DoxyCodeLine{8 \textcolor{comment}{ *     verra' salvato T al valore attuale. (Scritto in semplice C99 -\/> no Eigen::}}
\DoxyCodeLine{9 \textcolor{comment}{ *     e no std::)}}
\DoxyCodeLine{10 \textcolor{comment}{ * 4 -\/ Cercare di capire che analisi matematica vogliamo fare, propongo tre tipi}}
\DoxyCodeLine{11 \textcolor{comment}{ *     di documentazione: a) un file LaTeX con le info molto leggere}}
\DoxyCodeLine{12 \textcolor{comment}{ *     matematiche, una pagine di man per le info sull'utilizzo del software e}}
\DoxyCodeLine{13 \textcolor{comment}{ *     una pagina stile doxigen con gli oggetti e i metodi}}
\DoxyCodeLine{14 \textcolor{comment}{ * 5 -\/ E' la corretta astrazione quella realizzata? Magari facciamo meglio il}}
\DoxyCodeLine{15 \textcolor{comment}{ *     server web?}}
\DoxyCodeLine{16 \textcolor{comment}{ * X -\/ Quali parametri l'utente puÃ² modificare?}}
\DoxyCodeLine{17 \textcolor{comment}{ *}}
\DoxyCodeLine{18 \textcolor{comment}{ *LEGENDA ERRORI:}}
\DoxyCodeLine{19 \textcolor{comment}{ * return -\/1  END\_CICLE > 6000}}
\DoxyCodeLine{20 \textcolor{comment}{ * return -\/2  m\_TS=m\_TN}}
\DoxyCodeLine{21 \textcolor{comment}{ * return -\/3  m\_TN <= 0 oppure m\_TN >= m\_TS}}
\DoxyCodeLine{22 \textcolor{comment}{ * return -\/4  Ray\_numb < 50 || > 150}}
\DoxyCodeLine{23 \textcolor{comment}{ * return -\/5  Pr\_numb < 5 || > 9}}
\DoxyCodeLine{24 \textcolor{comment}{ * return -\/6  Re\_numb < 70 || > 130}}
\DoxyCodeLine{25 \textcolor{comment}{ * return -\/7  m\_TS >= 100}}
\DoxyCodeLine{26 \textcolor{comment}{}}
\DoxyCodeLine{27 \textcolor{comment}{ ******************************************************************/}}
\DoxyCodeLine{28 }
\DoxyCodeLine{29 }
\DoxyCodeLine{30 \textcolor{preprocessor}{\#include <iostream>}}
\DoxyCodeLine{31 \textcolor{preprocessor}{\#include <iomanip>}}
\DoxyCodeLine{32 \textcolor{preprocessor}{\#include <fstream>}}
\DoxyCodeLine{33 \textcolor{preprocessor}{\#include <cmath>}}
\DoxyCodeLine{34 \textcolor{preprocessor}{\#include <vector>}}
\DoxyCodeLine{35 \textcolor{preprocessor}{\#include <chrono>}}
\DoxyCodeLine{36 \textcolor{preprocessor}{\#include <thread>}}
\DoxyCodeLine{37 \textcolor{preprocessor}{\#include "{}Eigen/Eigen"{}}}
\DoxyCodeLine{38 \textcolor{preprocessor}{\#include "{}SuiteSparse\_config.h"{}}}
\DoxyCodeLine{39 \textcolor{preprocessor}{\#include "{}colamd.h"{}}}
\DoxyCodeLine{40 }
\DoxyCodeLine{41 \textcolor{preprocessor}{\#define NPROC 12}}
\DoxyCodeLine{42 \textcolor{preprocessor}{\#define OUTPUT\_HEADER\_FILE\_NAME "{}src/temperature\_matrix.h"{}}}
\DoxyCodeLine{43 }
\DoxyCodeLine{44 \textcolor{comment}{/*enum Warning\_bytes \{}}
\DoxyCodeLine{45 \textcolor{comment}{  delta\_temperature\_over\_10 = 00100000000000000000000000000000,}}
\DoxyCodeLine{46 \textcolor{comment}{  TN\_below\_4 = 00010000000000000000000000000000,}}
\DoxyCodeLine{47 \textcolor{comment}{\}}}
\DoxyCodeLine{48 \textcolor{comment}{*/}}
\DoxyCodeLine{49 }
\DoxyCodeLine{51 }
\DoxyCodeLine{56 \textcolor{keyword}{class }\mbox{\hyperlink{classRayBenConvection}{RayBenConvection}} \{}
\DoxyCodeLine{57 }
\DoxyCodeLine{58   \textcolor{keyword}{public}:}
\DoxyCodeLine{59 }
\DoxyCodeLine{61     \textcolor{keyword}{typedef} \textcolor{keyword}{struct }\{}
\DoxyCodeLine{63       \textcolor{keywordtype}{bool} \mbox{\hyperlink{structRayBenConvection_1_1simulation__state__t_ade312d660fc2a60c05ea13f92b4ae736}{ended}};}
\DoxyCodeLine{65       \textcolor{keywordtype}{int} \mbox{\hyperlink{structRayBenConvection_1_1simulation__state__t_a5c1453843717f44c32e784bc9cbdffc9}{total}};}
\DoxyCodeLine{67       \textcolor{keywordtype}{int} \mbox{\hyperlink{structRayBenConvection_1_1simulation__state__t_a7636474465caaee02b54a95190f43c49}{eta}};}
\DoxyCodeLine{69       \textcolor{keywordtype}{float} \mbox{\hyperlink{structRayBenConvection_1_1simulation__state__t_adc0f5503c9337c5406e05342a408ae92}{velocity}};}
\DoxyCodeLine{70       \} \mbox{\hyperlink{structRayBenConvection_1_1simulation__state__t}{simulation\_state\_t}};}
\DoxyCodeLine{71 }
\DoxyCodeLine{73     \mbox{\hyperlink{classRayBenConvection_ab8e70c8b84cee13bfe7a56300542d39b}{RayBenConvection}}(\textcolor{keywordtype}{void});}
\DoxyCodeLine{75     \mbox{\hyperlink{classRayBenConvection_ad210586418c880516f3f619e29ff536f}{\string~RayBenConvection}}(\textcolor{keywordtype}{void});}
\DoxyCodeLine{76 }
\DoxyCodeLine{77     \textcolor{keywordtype}{int} \mbox{\hyperlink{classRayBenConvection_af068a10b389817887e3f91bf9bff965a}{init}}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}, \textcolor{keywordtype}{double}, \textcolor{keywordtype}{double}, \textcolor{keywordtype}{double}, \textcolor{keywordtype}{double}, \textcolor{keywordtype}{double});}
\DoxyCodeLine{78 }
\DoxyCodeLine{79     \mbox{\hyperlink{structRayBenConvection_1_1simulation__state__t}{simulation\_state\_t}} eval\_next\_frame(\textcolor{keywordtype}{void});}
\DoxyCodeLine{80 }
\DoxyCodeLine{81     \textcolor{keywordtype}{void} write\_current\_data(\textcolor{keywordtype}{void});}
\DoxyCodeLine{82 }
\DoxyCodeLine{83   \textcolor{keyword}{private}:}
\DoxyCodeLine{84     \textcolor{comment}{//variables}}
\DoxyCodeLine{86 \textcolor{comment}{}    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{classRayBenConvection_a30361d2ad21ab61d60fb8bb21fba82de}{m\_END\_CICLE}};}
\DoxyCodeLine{88     \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{classRayBenConvection_a00ece8699bc4531e4dc5edfe2cfcfd7b}{m\_nx}} = 100;}
\DoxyCodeLine{90     \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{classRayBenConvection_aa2e29e985716895f8f19e3930078ec00}{m\_ny}} = 70;}
\DoxyCodeLine{92     \textcolor{keyword}{const} \textcolor{keywordtype}{double} \mbox{\hyperlink{classRayBenConvection_a8b38201fb9bd541ccb0974df9d61c22c}{m\_tf}} = 1e3;}
\DoxyCodeLine{94     \textcolor{keywordtype}{double} \mbox{\hyperlink{classRayBenConvection_ae106f4c67cc111c54d23730e8e7fa7e6}{m\_dt}} = 1e-\/2;}
\DoxyCodeLine{96     \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{classRayBenConvection_a6a6f9567a98085c522e319da90d0b6c6}{m\_nt}} = ((int) \mbox{\hyperlink{classRayBenConvection_a8b38201fb9bd541ccb0974df9d61c22c}{m\_tf}} / \mbox{\hyperlink{classRayBenConvection_ae106f4c67cc111c54d23730e8e7fa7e6}{m\_dt}}) + 1;}
\DoxyCodeLine{98 }
\DoxyCodeLine{104     \textcolor{keyword}{const} \textcolor{keywordtype}{double} \mbox{\hyperlink{classRayBenConvection_a500821275948ffaeb5dbac835f618515}{m\_H}} = 2;}
\DoxyCodeLine{106 }
\DoxyCodeLine{109     \textcolor{keyword}{const} \textcolor{keywordtype}{double} \mbox{\hyperlink{classRayBenConvection_a018296501774061a9fc4d07ee3ccc684}{m\_L}} = 5;}
\DoxyCodeLine{111     \textcolor{keyword}{const} \textcolor{keywordtype}{double} \mbox{\hyperlink{classRayBenConvection_a2bb417e336a4ae74e517e2eba04d179d}{m\_dx}} = \mbox{\hyperlink{classRayBenConvection_a018296501774061a9fc4d07ee3ccc684}{m\_L}} / (\mbox{\hyperlink{classRayBenConvection_a00ece8699bc4531e4dc5edfe2cfcfd7b}{m\_nx}} -\/ 1);}
\DoxyCodeLine{113     \textcolor{keyword}{const} \textcolor{keywordtype}{double} \mbox{\hyperlink{classRayBenConvection_a6d70b64b68c44a8b5f4ed5ca86dfcf71}{m\_dy}} = \mbox{\hyperlink{classRayBenConvection_a500821275948ffaeb5dbac835f618515}{m\_H}} / (\mbox{\hyperlink{classRayBenConvection_aa2e29e985716895f8f19e3930078ec00}{m\_ny}} -\/ 1);}
\DoxyCodeLine{115     \textcolor{keywordtype}{double} \mbox{\hyperlink{classRayBenConvection_a0fade52114cb600deba397e9c3d86b12}{m\_TN}};}
\DoxyCodeLine{117     \textcolor{keywordtype}{double} \mbox{\hyperlink{classRayBenConvection_ac1331aa9a8a5f7b079af0df68bc3dcfc}{m\_TS}};}
\DoxyCodeLine{119     Eigen::Matrix<double, m\_nx+1, m\_ny> \mbox{\hyperlink{classRayBenConvection_ac9933db8381584f9d732b85391da2533}{m\_u}};}
\DoxyCodeLine{121     Eigen::Matrix<double, m\_nx, m\_ny+1> \mbox{\hyperlink{classRayBenConvection_af863193c10cffeaf20f749df0ec845a5}{m\_v}};}
\DoxyCodeLine{123     Eigen::Matrix<double, m\_nx, m\_ny> \mbox{\hyperlink{classRayBenConvection_a66828b8a9611c0a5dac1eeb64d1fa614}{m\_p}};}
\DoxyCodeLine{125     Eigen::Matrix<double, m\_nx, m\_ny> \mbox{\hyperlink{classRayBenConvection_a2bf183a03e99f6a9b2a6f4139f780ec3}{m\_S}};}
\DoxyCodeLine{127     \textcolor{keywordtype}{double} \mbox{\hyperlink{classRayBenConvection_abfa7478fe1bf2a2744403d17ca248a3d}{m\_To}};}
\DoxyCodeLine{129     Eigen::Matrix<double, m\_nx, m\_ny> \mbox{\hyperlink{classRayBenConvection_aecfd1a81f7bc8e559a3d17237ebf227c}{m\_T}};}
\DoxyCodeLine{131     \textcolor{keywordtype}{double} \mbox{\hyperlink{classRayBenConvection_a9558a662a91ef2887302e7f8913654b9}{m\_Re}};}
\DoxyCodeLine{133     \textcolor{keywordtype}{double} \mbox{\hyperlink{classRayBenConvection_af246c10dd8e2c4f9fe3951d74453e9e0}{m\_Pr}};}
\DoxyCodeLine{135     \textcolor{keywordtype}{double} m\_Pe;}
\DoxyCodeLine{137     \textcolor{keywordtype}{double} \mbox{\hyperlink{classRayBenConvection_a6eade7fabf66cfd00e19bdbc7f057341}{m\_Ra}};}
\DoxyCodeLine{139     \textcolor{keywordtype}{double} m\_Gr;}
\DoxyCodeLine{141     Eigen::Matrix<double, m\_nx, m\_ny> \mbox{\hyperlink{classRayBenConvection_a0369de1dcfd6a9c4681a22ef77281bad}{m\_Tstar}};}
\DoxyCodeLine{143     Eigen::Matrix<double, m\_nx+1, m\_ny> \mbox{\hyperlink{classRayBenConvection_a22bceb43d4d9ba695f21bf1306a8f354}{m\_ustar}};}
\DoxyCodeLine{145     Eigen::Matrix<double, m\_nx+1, m\_ny> \mbox{\hyperlink{classRayBenConvection_ab1204d12009f19080daa8e48072854cd}{m\_uhalf}};}
\DoxyCodeLine{147     Eigen::Matrix<double, m\_nx+1, m\_ny> \mbox{\hyperlink{classRayBenConvection_a316a9e7f0c079b6fba771d7b15bd6647}{m\_uconv}};}
\DoxyCodeLine{149     Eigen::Matrix<double, m\_nx, m\_ny+1> \mbox{\hyperlink{classRayBenConvection_a8e8d1bec9c3fbd2876adc957f4ed767d}{m\_vstar}};}
\DoxyCodeLine{151     Eigen::Matrix<double, m\_nx, m\_ny+1> \mbox{\hyperlink{classRayBenConvection_aeada1a30f797e981b52d3b4e0640b198}{m\_vhalf}};}
\DoxyCodeLine{153     Eigen::Matrix<double, m\_nx, m\_ny+1> \mbox{\hyperlink{classRayBenConvection_a2e5088ea41b7faad0bcc9bfda83939ef}{m\_vconv}};}
\DoxyCodeLine{155     \textcolor{keywordtype}{double} \mbox{\hyperlink{classRayBenConvection_aeb469e88e053251916cbcf2e0dd1919a}{m\_TnE}} = 0;}
\DoxyCodeLine{157     \textcolor{keywordtype}{double} \mbox{\hyperlink{classRayBenConvection_a643232d08102a38ddd0ec9a618b55afd}{m\_TnW}} = 0;}
\DoxyCodeLine{159     \textcolor{keywordtype}{double} \mbox{\hyperlink{classRayBenConvection_aab15fee9f0b6d470dd9d02d85439a7a8}{m\_UN}} = 0;}
\DoxyCodeLine{161     \textcolor{keywordtype}{double} \mbox{\hyperlink{classRayBenConvection_a99f0d9ab29a2db33829175a790fa9bc7}{m\_US}} = 0;}
\DoxyCodeLine{163     \textcolor{keywordtype}{double} \mbox{\hyperlink{classRayBenConvection_ad3b4ec6a6500a9b9355c60d66a62091b}{m\_UE}} = 0;}
\DoxyCodeLine{165     \textcolor{keywordtype}{double} \mbox{\hyperlink{classRayBenConvection_a56534034d797d9099f53367d4828f0c7}{m\_UW}} = 0;}
\DoxyCodeLine{167     \textcolor{keywordtype}{double} \mbox{\hyperlink{classRayBenConvection_ace7b32dda44cace25edfe8e481601733}{m\_VN}} = 0;}
\DoxyCodeLine{169     \textcolor{keywordtype}{double} \mbox{\hyperlink{classRayBenConvection_afc0d1ada59367f173257a20e2cea845b}{m\_VS}} = 0;}
\DoxyCodeLine{171     \textcolor{keywordtype}{double} \mbox{\hyperlink{classRayBenConvection_abfccbde057005c07f8ee2b76ef68e4f7}{m\_VE}} = 0;}
\DoxyCodeLine{173     \textcolor{keywordtype}{double} \mbox{\hyperlink{classRayBenConvection_aee29299c3f2cf435a3d179d4dcd9b0a1}{m\_VW}} = 0;}
\DoxyCodeLine{175     Eigen::Matrix<double, \mbox{\hyperlink{classRayBenConvection_a00ece8699bc4531e4dc5edfe2cfcfd7b}{m\_nx}}-\/1, \mbox{\hyperlink{classRayBenConvection_aa2e29e985716895f8f19e3930078ec00}{m\_ny}}-\/2> \mbox{\hyperlink{classRayBenConvection_ab25ed57d64bce95a1f0b385151be1a41}{m\_bcu}};}
\DoxyCodeLine{177     Eigen::Matrix<double, \mbox{\hyperlink{classRayBenConvection_a00ece8699bc4531e4dc5edfe2cfcfd7b}{m\_nx}}-\/2, \mbox{\hyperlink{classRayBenConvection_aa2e29e985716895f8f19e3930078ec00}{m\_ny}}-\/1> \mbox{\hyperlink{classRayBenConvection_ae8a99eaf006353101cd1cb4cd6803da4}{m\_bcv}};}
\DoxyCodeLine{179     Eigen::Matrix<double, -\/1, 1> \mbox{\hyperlink{classRayBenConvection_abbc6bb7a871ccde05c4b5a9519eb7cd8}{m\_e}};}
\DoxyCodeLine{181     Eigen::Matrix<double, -\/1, 1> \mbox{\hyperlink{classRayBenConvection_ada01bc16d6b738fef671eb8c21461d40}{m\_i}};}
\DoxyCodeLine{183     Eigen::Matrix<double, -\/1, -\/1> \mbox{\hyperlink{classRayBenConvection_a355433f2d50e67c93b922803b52afcb6}{m\_Ax}};}
\DoxyCodeLine{185     Eigen::Matrix<double, -\/1, -\/1> \mbox{\hyperlink{classRayBenConvection_a87b2a19b366009db54a377461aaf2768}{m\_Ay}};}
\DoxyCodeLine{187     Eigen::Matrix<double, -\/1, -\/1> \mbox{\hyperlink{classRayBenConvection_a279afbe74b425c0a05bdcc3f854ebe79}{m\_A}};}
\DoxyCodeLine{189     Eigen::Matrix<double, -\/1, -\/1> \mbox{\hyperlink{classRayBenConvection_aa94ce938fcecf4c51febe3c19efca332}{m\_Du}};}
\DoxyCodeLine{191     Eigen::Matrix<int, 1, -\/1> \mbox{\hyperlink{classRayBenConvection_ae3f0ffb3cfe0c04d2ad97caa1b66657d}{m\_pu}};}
\DoxyCodeLine{193     Eigen::Matrix<double, -\/1, -\/1> \mbox{\hyperlink{classRayBenConvection_afc73f1c4923484d2891bb9a9b48620bb}{m\_Duperm}};}
\DoxyCodeLine{195     std::vector<Eigen::Matrix<double, -\/1, -\/1>> \mbox{\hyperlink{classRayBenConvection_a2c0c7f84f7a1a702878f9980a4772bc0}{m\_LUu}};}
\DoxyCodeLine{197     Eigen::Matrix<double, -\/1, -\/1> \mbox{\hyperlink{classRayBenConvection_a750b160d5cfc7fd029936245e9b2ba76}{m\_Dv}};}
\DoxyCodeLine{199     Eigen::Matrix<int, 1, -\/1> \mbox{\hyperlink{classRayBenConvection_aa052588ce5527b7315207f19504843c5}{m\_pv}};}
\DoxyCodeLine{201     Eigen::Matrix<double, -\/1, -\/1> \mbox{\hyperlink{classRayBenConvection_a566fcdb354ab8ab44549aa1698e69ea3}{m\_Dvperm}};}
\DoxyCodeLine{202     \textcolor{comment}{// std vector of Eigen matrices.}}
\DoxyCodeLine{203     std::vector<Eigen::Matrix<double, -\/1, -\/1>> m\_LUv;}
\DoxyCodeLine{205     Eigen::Matrix<int, 1, -\/1> \mbox{\hyperlink{classRayBenConvection_a1feee928e15de6738a5c468fc10ab263}{m\_pp}};}
\DoxyCodeLine{207     Eigen::Matrix<double, -\/1, -\/1> \mbox{\hyperlink{classRayBenConvection_a529194ad06a9e9a2f13259c7620aeade}{m\_Aperm}};}
\DoxyCodeLine{209     std::vector<Eigen::Matrix<double, -\/1, -\/1>> \mbox{\hyperlink{classRayBenConvection_ac749448feff68e1d70ba6df4c6b6308d}{m\_LUp}};}
\DoxyCodeLine{211     Eigen::Matrix<double, \mbox{\hyperlink{classRayBenConvection_a00ece8699bc4531e4dc5edfe2cfcfd7b}{m\_nx}}-\/2, \mbox{\hyperlink{classRayBenConvection_aa2e29e985716895f8f19e3930078ec00}{m\_ny}}-\/2> \mbox{\hyperlink{classRayBenConvection_a0bce1c4229b75dd03d882abcc7612e8c}{m\_bcT}};}
\DoxyCodeLine{213     Eigen::Matrix<double, -\/1, -\/1> \mbox{\hyperlink{classRayBenConvection_aecd4a1a57801dd8f6b8287b3903de288}{m\_Tx}};}
\DoxyCodeLine{215     Eigen::Matrix<double, -\/1, -\/1> \mbox{\hyperlink{classRayBenConvection_accf0b01090460e7a90bbae1e983b27b9}{m\_Ty}};}
\DoxyCodeLine{217     Eigen::Matrix<double, -\/1, -\/1> \mbox{\hyperlink{classRayBenConvection_af531dfbb0312d1411695bc513f9fc3ab}{m\_Tt}};}
\DoxyCodeLine{219     Eigen::Matrix<int, 1, -\/1> \mbox{\hyperlink{classRayBenConvection_a29a766e0a44d52126e84113fab8bc790}{m\_pt}};}
\DoxyCodeLine{221     Eigen::Matrix<double, -\/1, -\/1> \mbox{\hyperlink{classRayBenConvection_a20f9d47123df134ba81616d5c9ce7829}{m\_Ttperm}};}
\DoxyCodeLine{223     std::vector<Eigen::Matrix<double, -\/1, -\/1>> \mbox{\hyperlink{classRayBenConvection_a9fe814ef49f949598da4f414870da1d3}{m\_LUt}};}
\DoxyCodeLine{225     Eigen::PartialPivLU<Eigen::Matrix<double, -\/1, -\/1>> \mbox{\hyperlink{classRayBenConvection_aaf54f2309f7ac98e9f2cc449eae6bd37}{m\_Lu\_solver}};}
\DoxyCodeLine{227     Eigen::PartialPivLU<Eigen::Matrix<double, -\/1, -\/1>> \mbox{\hyperlink{classRayBenConvection_abc851be2138ae32b40834060bffe5a69}{m\_Uu\_solver}};}
\DoxyCodeLine{229     Eigen::PartialPivLU<Eigen::Matrix<double, -\/1, -\/1>> \mbox{\hyperlink{classRayBenConvection_ab7a3c25d7d180499643a96b52c376ef8}{m\_Lv\_solver}};}
\DoxyCodeLine{231     Eigen::PartialPivLU<Eigen::Matrix<double, -\/1, -\/1>> \mbox{\hyperlink{classRayBenConvection_a41024c3b9faa8588e3ecd679203b2e4c}{m\_Uv\_solver}};}
\DoxyCodeLine{233     Eigen::PartialPivLU<Eigen::Matrix<double, -\/1, -\/1>> \mbox{\hyperlink{classRayBenConvection_a6287ec3344a639bccc0ae10bb04aa900}{m\_Lp\_solver}};}
\DoxyCodeLine{235     Eigen::PartialPivLU<Eigen::Matrix<double, -\/1, -\/1>> \mbox{\hyperlink{classRayBenConvection_ad38e2b16fa2e62e025fdcf2951266761}{m\_Up\_solver}};}
\DoxyCodeLine{237     Eigen::PartialPivLU<Eigen::Matrix<double, -\/1, -\/1>> \mbox{\hyperlink{classRayBenConvection_a8d69aac2c20b371f05105b46b893f76c}{m\_Lt\_solver}};}
\DoxyCodeLine{239     Eigen::PartialPivLU<Eigen::Matrix<double, -\/1, -\/1>> \mbox{\hyperlink{classRayBenConvection_a02288b2063d3f4a257791f0fe5933b81}{m\_Ut\_solver}};}
\DoxyCodeLine{241     \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{classRayBenConvection_ad5d8335e885b5f4d0860b379d785eb24}{m\_ii}} = \mbox{\hyperlink{classRayBenConvection_a00ece8699bc4531e4dc5edfe2cfcfd7b}{m\_nx}}-\/2;}
\DoxyCodeLine{243     \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{classRayBenConvection_a3f18799795eb3b79188f14aeed0c427b}{m\_jj}} = \mbox{\hyperlink{classRayBenConvection_aa2e29e985716895f8f19e3930078ec00}{m\_ny}}-\/2;}
\DoxyCodeLine{245     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \mbox{\hyperlink{classRayBenConvection_af8611d2ad5bd585ec902c30895c8a916}{m\_it}};}
\DoxyCodeLine{247     std::ofstream \mbox{\hyperlink{classRayBenConvection_a1efa7e03cd0d72a7901f47dd575bfdc5}{m\_output\_header\_file}};}
\DoxyCodeLine{251     \mbox{\hyperlink{structRayBenConvection_1_1simulation__state__t}{simulation\_state\_t}} \mbox{\hyperlink{classRayBenConvection_a4922c04914255acd890452879eee7a8e}{simulation\_state}};}
\DoxyCodeLine{252 }
\DoxyCodeLine{253     \textcolor{comment}{//functions}}
\DoxyCodeLine{254     \textcolor{keywordtype}{void} \mbox{\hyperlink{classRayBenConvection_a834f45458ac6473a81c3457603809cd3}{m\_apply\_correction}}(\textcolor{keywordtype}{void});}
\DoxyCodeLine{255     \textcolor{keyword}{static} \textcolor{keywordtype}{void} \mbox{\hyperlink{classRayBenConvection_a103559797e2c0013967de38b22af97f2}{m\_d\_solve}}(Eigen::Matrix<double,-\/1,1> \&,}
\DoxyCodeLine{256             \textcolor{keyword}{const} Eigen::Matrix<int,1,-\/1> \&,}
\DoxyCodeLine{257             \textcolor{keyword}{const} Eigen::PartialPivLU<Eigen::Matrix<double,-\/1,-\/1>> \&,}
\DoxyCodeLine{258             \textcolor{keyword}{const} Eigen::PartialPivLU<Eigen::Matrix<double,-\/1,-\/1>> \&);}
\DoxyCodeLine{259     \textcolor{keywordtype}{void} m\_ETA(\textcolor{keywordtype}{int});}
\DoxyCodeLine{260 }
\DoxyCodeLine{261     \textcolor{keyword}{template} <\textcolor{keyword}{typename} Scalar> }
\DoxyCodeLine{262     Eigen::Matrix<Scalar,-\/1,-\/1> m\_spdiags(\textcolor{keyword}{const} Eigen::Matrix<Scalar, -\/1, -\/1> \&, }
\DoxyCodeLine{263                                     \textcolor{keyword}{const} Eigen::Matrix<int, -\/1, 1> \&,}
\DoxyCodeLine{264                                     \textcolor{keywordtype}{size\_t}, \textcolor{keywordtype}{size\_t});}
\DoxyCodeLine{265     \textcolor{keyword}{template} <\textcolor{keyword}{typename} Scalar> }
\DoxyCodeLine{266     Eigen::Matrix<Scalar,-\/1,-\/1> m\_kron(\textcolor{keyword}{const} Eigen::Matrix<Scalar, -\/1, -\/1> \&,}
\DoxyCodeLine{267                                  \textcolor{keyword}{const} Eigen::Matrix<Scalar, -\/1, -\/1> \&);}
\DoxyCodeLine{268 }
\DoxyCodeLine{269     \textcolor{keyword}{template} <\textcolor{keyword}{typename} Scalar>}
\DoxyCodeLine{270     std::vector<Eigen::Triplet<Scalar>> m\_SparseToTriplet(Eigen::SparseMatrix<Scalar> \&);}
\DoxyCodeLine{271     \textcolor{keyword}{template} <\textcolor{keyword}{typename} Scalar>}
\DoxyCodeLine{272 }
\DoxyCodeLine{273     Eigen::Matrix<int, 1, -\/1> m\_my\_symamd(Eigen::Matrix<Scalar, -\/1, -\/1> \&); }
\DoxyCodeLine{274 }
\DoxyCodeLine{275     \textcolor{keywordtype}{void} m\_luP(Eigen::Matrix<double,-\/1,-\/1> \&, std::vector<Eigen::Matrix<double,-\/1,-\/1>> \&);}
\DoxyCodeLine{276     \textcolor{keywordtype}{void} m\_write\_current\_frame();}
\DoxyCodeLine{277 \};}
\DoxyCodeLine{278 }
\DoxyCodeLine{279 \mbox{\hyperlink{classRayBenConvection_ab8e70c8b84cee13bfe7a56300542d39b}{RayBenConvection::RayBenConvection}}() \{\}}
\DoxyCodeLine{280 }
\DoxyCodeLine{281 \mbox{\hyperlink{classRayBenConvection_ad210586418c880516f3f619e29ff536f}{RayBenConvection::\string~RayBenConvection}}() \{\}}
\DoxyCodeLine{282 }
\DoxyCodeLine{284 }
\DoxyCodeLine{291 \textcolor{keywordtype}{void} \mbox{\hyperlink{classRayBenConvection_a834f45458ac6473a81c3457603809cd3}{RayBenConvection::m\_apply\_correction}}(\textcolor{keywordtype}{void}) \{}
\DoxyCodeLine{292   \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i = 0; i < \mbox{\hyperlink{classRayBenConvection_aecfd1a81f7bc8e559a3d17237ebf227c}{m\_T}}.rows(); ++i) \{}
\DoxyCodeLine{293     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} k = 0; k < \mbox{\hyperlink{classRayBenConvection_aecfd1a81f7bc8e559a3d17237ebf227c}{m\_T}}.cols(); ++k) \{}
\DoxyCodeLine{294       \textcolor{keywordflow}{if}((\mbox{\hyperlink{classRayBenConvection_aecfd1a81f7bc8e559a3d17237ebf227c}{m\_T}}(i, k) < \mbox{\hyperlink{classRayBenConvection_a0fade52114cb600deba397e9c3d86b12}{m\_TN}}) || (\mbox{\hyperlink{classRayBenConvection_aecfd1a81f7bc8e559a3d17237ebf227c}{m\_T}}(i, k) > \mbox{\hyperlink{classRayBenConvection_ac1331aa9a8a5f7b079af0df68bc3dcfc}{m\_TS}})) \{}
\DoxyCodeLine{295         \mbox{\hyperlink{classRayBenConvection_aecfd1a81f7bc8e559a3d17237ebf227c}{m\_T}}(i, k) = \mbox{\hyperlink{classRayBenConvection_a0fade52114cb600deba397e9c3d86b12}{m\_TN}};}
\DoxyCodeLine{296       \}}
\DoxyCodeLine{297     \}}
\DoxyCodeLine{298   \}}
\DoxyCodeLine{299 \}}
\DoxyCodeLine{300 }
\DoxyCodeLine{301 \textcolor{comment}{//void RayBenConvection::m\_printColor (Color c) \{}}
\DoxyCodeLine{302 \textcolor{comment}{//  ::printf("{}(\%d, \%d, \%d, \%d)\(\backslash\)n"{}, c.r, c.g, c.b, c.a);}}
\DoxyCodeLine{303 \textcolor{comment}{//\}}}
\DoxyCodeLine{304 }
\DoxyCodeLine{305 \textcolor{comment}{//Color RayBenConvection::m\_TtoC (double cold\_temp, double hot\_temp,  double T) \{}}
\DoxyCodeLine{306   \textcolor{comment}{/*}}
\DoxyCodeLine{307 \textcolor{comment}{  (x -\/ in\_min) * (out\_max -\/ out\_min) / (in\_max -\/ in\_min) + out\_min}}
\DoxyCodeLine{308 \textcolor{comment}{  */}}
\DoxyCodeLine{309 \textcolor{comment}{//  if ((T <= hot\_temp) \&\& (T >= cold\_temp)) \{}}
\DoxyCodeLine{310 \textcolor{comment}{//    int index = (T -\/ cold\_temp) * (jet.size() -\/ 1) / ( hot\_temp -\/ cold\_temp );}}
\DoxyCodeLine{311 \textcolor{comment}{//    return jet[index];}}
\DoxyCodeLine{312 \textcolor{comment}{//  \} else \{}}
\DoxyCodeLine{313 \textcolor{comment}{//    return (Color)\{0, 0, 0, 0\};}}
\DoxyCodeLine{314 \textcolor{comment}{//  \}}}
\DoxyCodeLine{315 \textcolor{comment}{//\}}}
\DoxyCodeLine{316 }
\DoxyCodeLine{318 }
\DoxyCodeLine{324 \textcolor{keywordtype}{void} \mbox{\hyperlink{classRayBenConvection_a103559797e2c0013967de38b22af97f2}{RayBenConvection::m\_d\_solve}}(Eigen::Matrix<double,-\/1,1> \&mat,}
\DoxyCodeLine{325            \textcolor{keyword}{const} Eigen::Matrix<int,1,-\/1> \&perm,}
\DoxyCodeLine{326            \textcolor{keyword}{const} Eigen::PartialPivLU<Eigen::Matrix<double,-\/1,-\/1>> \&L,}
\DoxyCodeLine{327            \textcolor{keyword}{const} Eigen::PartialPivLU<Eigen::Matrix<double,-\/1,-\/1>> \&U) \{}
\DoxyCodeLine{328   mat(perm) = \textcolor{keyword}{static\_cast<}Eigen::Matrix<\textcolor{keywordtype}{double},-\/1,-\/1\textcolor{keyword}{>}>(U.solve(L.solve(mat(perm))));}
\DoxyCodeLine{329 \}}
\DoxyCodeLine{330 }
\DoxyCodeLine{331 }
\DoxyCodeLine{332 \textcolor{comment}{//void RayBenConvection::m\_Draw(double cold\_temp, double hot\_temp, const Eigen::Matrix<double, -\/1, -\/1> \&T)}}
\DoxyCodeLine{333 \textcolor{comment}{//\{}}
\DoxyCodeLine{334 \textcolor{comment}{//  const unsigned int nx = T.rows();}}
\DoxyCodeLine{335 \textcolor{comment}{//  const unsigned int ny = T.cols();}}
\DoxyCodeLine{336 \textcolor{comment}{//  ::BeginDrawing();}}
\DoxyCodeLine{337 \textcolor{comment}{//    ::ClearBackground((Color)\{ 255, 255, 255, 255\});}}
\DoxyCodeLine{338 \textcolor{comment}{//    for(unsigned int i = 0; i < nx; ++i) \{}}
\DoxyCodeLine{339 \textcolor{comment}{//      for(unsigned int k = 0; k < ny; ++k) \{}}
\DoxyCodeLine{340 \textcolor{comment}{//        ::DrawRectangle((WINDOW\_WIDTH/2 -\/ nx*PIXEL/2) + i*PIXEL, }}
\DoxyCodeLine{341 \textcolor{comment}{//                       (WINDOW\_HEIGHT/2 + ny*PIXEL/2) -\/ k*PIXEL, }}
\DoxyCodeLine{342 \textcolor{comment}{//                       PIXEL, PIXEL, m\_TtoC(cold\_temp, hot\_temp, T(i, k)));}}
\DoxyCodeLine{343 \textcolor{comment}{//      \}}}
\DoxyCodeLine{344 \textcolor{comment}{//    \}}}
\DoxyCodeLine{345   }
\DoxyCodeLine{346 \textcolor{comment}{//    int posY = 5;}}
\DoxyCodeLine{347 \textcolor{comment}{//    for(unsigned int i = 0; i < jet.size(); ++i) \{}}
\DoxyCodeLine{348 \textcolor{comment}{//      ::DrawRectangle(5, posY, 5, 1, jet[i]);}}
\DoxyCodeLine{349 \textcolor{comment}{//      posY += 1;}}
\DoxyCodeLine{350 \textcolor{comment}{//    \}}}
\DoxyCodeLine{351 \textcolor{comment}{//  ::EndDrawing();}}
\DoxyCodeLine{352 \textcolor{comment}{//\}}}
\DoxyCodeLine{353 }
\DoxyCodeLine{354 \textcolor{keywordtype}{void} RayBenConvection::m\_ETA(\textcolor{keywordtype}{int} n\_calls)\{}
\DoxyCodeLine{355   \textcolor{keyword}{static} std::chrono::time\_point<std::chrono::high\_resolution\_clock> old\_time;}
\DoxyCodeLine{356   \textcolor{keywordtype}{float} delta\_t;}
\DoxyCodeLine{357 }
\DoxyCodeLine{358   ++n\_calls;}
\DoxyCodeLine{359   \textcolor{keywordflow}{if}(n\_calls > 1) \{}
\DoxyCodeLine{360     delta\_t = \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{float}\textcolor{keyword}{>}(}
\DoxyCodeLine{361         std::chrono::duration\_cast<std::chrono::milliseconds>(}
\DoxyCodeLine{362           std::chrono::high\_resolution\_clock::now() -\/ old\_time}
\DoxyCodeLine{363         ).count()}
\DoxyCodeLine{364     ) / 1000;}
\DoxyCodeLine{365     \textcolor{keywordflow}{if}(delta\_t > 0) \{}
\DoxyCodeLine{366       \mbox{\hyperlink{classRayBenConvection_a4922c04914255acd890452879eee7a8e}{simulation\_state}}.\mbox{\hyperlink{structRayBenConvection_1_1simulation__state__t_a5c1453843717f44c32e784bc9cbdffc9}{total}} = \mbox{\hyperlink{classRayBenConvection_a30361d2ad21ab61d60fb8bb21fba82de}{m\_END\_CICLE}};}
\DoxyCodeLine{367       \mbox{\hyperlink{classRayBenConvection_a4922c04914255acd890452879eee7a8e}{simulation\_state}}.\mbox{\hyperlink{structRayBenConvection_1_1simulation__state__t_a7636474465caaee02b54a95190f43c49}{eta}} = delta\_t * (\mbox{\hyperlink{classRayBenConvection_a30361d2ad21ab61d60fb8bb21fba82de}{m\_END\_CICLE}} -\/ n\_calls);}
\DoxyCodeLine{368       \mbox{\hyperlink{classRayBenConvection_a4922c04914255acd890452879eee7a8e}{simulation\_state}}.\mbox{\hyperlink{structRayBenConvection_1_1simulation__state__t_adc0f5503c9337c5406e05342a408ae92}{velocity}} = 1.0/delta\_t;}
\DoxyCodeLine{369       \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i = 0; i < 80; ++i)}
\DoxyCodeLine{370         std::putc(\textcolor{charliteral}{' '}, stdout);}
\DoxyCodeLine{371       std::cerr << \textcolor{stringliteral}{"{}\(\backslash\)rINFO: RayBenConvection: m\_ETA: eta = "{}} }
\DoxyCodeLine{372                 << std::setw(4) << std::setprecision(3)}
\DoxyCodeLine{373                 << \mbox{\hyperlink{classRayBenConvection_a4922c04914255acd890452879eee7a8e}{simulation\_state}}.\mbox{\hyperlink{structRayBenConvection_1_1simulation__state__t_a7636474465caaee02b54a95190f43c49}{eta}} << \textcolor{stringliteral}{"{}s\(\backslash\)tspeed = "{}}}
\DoxyCodeLine{374                 << \mbox{\hyperlink{classRayBenConvection_a4922c04914255acd890452879eee7a8e}{simulation\_state}}.\mbox{\hyperlink{structRayBenConvection_1_1simulation__state__t_adc0f5503c9337c5406e05342a408ae92}{velocity}} << \textcolor{stringliteral}{"{}cicle/s\(\backslash\)tstep = "{}}}
\DoxyCodeLine{375                 << n\_calls << \textcolor{stringliteral}{"{}/"{}} << \mbox{\hyperlink{classRayBenConvection_a4922c04914255acd890452879eee7a8e}{simulation\_state}}.\mbox{\hyperlink{structRayBenConvection_1_1simulation__state__t_a5c1453843717f44c32e784bc9cbdffc9}{total}} << \textcolor{stringliteral}{"{}\(\backslash\)r"{}};}
\DoxyCodeLine{376       ::fflush(stdout);}
\DoxyCodeLine{377     \}}
\DoxyCodeLine{378   \}}
\DoxyCodeLine{379   old\_time = std::chrono::high\_resolution\_clock::now();}
\DoxyCodeLine{380   \textcolor{keywordflow}{return};}
\DoxyCodeLine{381 \}}
\DoxyCodeLine{382 }
\DoxyCodeLine{383 \textcolor{keyword}{template} <\textcolor{keyword}{typename} Scalar> }
\DoxyCodeLine{384 Eigen::Matrix<Scalar,-\/1,-\/1> RayBenConvection::m\_spdiags(\textcolor{keyword}{const} Eigen::Matrix<Scalar, -\/1, -\/1>\& B, }
\DoxyCodeLine{385                                     \textcolor{keyword}{const} Eigen::Matrix<int, -\/1, 1>\& d,}
\DoxyCodeLine{386                                     \textcolor{keywordtype}{size\_t} m, \textcolor{keywordtype}{size\_t} n) \{}
\DoxyCodeLine{387   Eigen::SparseMatrix<Scalar> A(m,n);}
\DoxyCodeLine{388 }
\DoxyCodeLine{389   \textcolor{keyword}{typedef} Eigen::Triplet<Scalar> T;}
\DoxyCodeLine{390   std::vector<T> triplets;}
\DoxyCodeLine{391   triplets.reserve(std::min(m,n)*d.size());}
\DoxyCodeLine{392 }
\DoxyCodeLine{393   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} k = 0; k < d.size(); k++) \{}
\DoxyCodeLine{394     \textcolor{keywordtype}{int} i\_min = std::max(0, -\/d(k));}
\DoxyCodeLine{395     \textcolor{keywordtype}{int} i\_max = std::min(m -\/ 1, n -\/ d(k) -\/ 1);}
\DoxyCodeLine{396     \textcolor{keywordtype}{int} B\_im\_dx\_start = m >= n ? d(k) : 0;}
\DoxyCodeLine{397 }
\DoxyCodeLine{398     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = i\_min; i <= i\_max; i++) \{}
\DoxyCodeLine{399       triplets.push\_back( T(i, i+d(k), B(B\_im\_dx\_start + i, k)) );}
\DoxyCodeLine{400     \}}
\DoxyCodeLine{401   \}}
\DoxyCodeLine{402 }
\DoxyCodeLine{403   A.setFromTriplets(triplets.begin(), triplets.end());}
\DoxyCodeLine{404 }
\DoxyCodeLine{405   \textcolor{keywordflow}{return} Eigen::Matrix<Scalar, -\/1, -\/1>(A);}
\DoxyCodeLine{406 \}}
\DoxyCodeLine{407 }
\DoxyCodeLine{408 \textcolor{keyword}{template} <\textcolor{keyword}{typename} Scalar> }
\DoxyCodeLine{409 Eigen::Matrix<Scalar,-\/1,-\/1> RayBenConvection::m\_kron(\textcolor{keyword}{const} Eigen::Matrix<Scalar, -\/1, -\/1>\& B, }
\DoxyCodeLine{410                                  \textcolor{keyword}{const} Eigen::Matrix<Scalar, -\/1, -\/1>\& d) \{}
\DoxyCodeLine{411   Eigen::Matrix<Scalar, -\/1, -\/1> A;}
\DoxyCodeLine{412   A.resize(B.rows()*d.rows(), B.cols()*d.cols());}
\DoxyCodeLine{413   }
\DoxyCodeLine{414   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < B.rows(); i++) }
\DoxyCodeLine{415     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < B.cols(); j++) }
\DoxyCodeLine{416       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} h = 0; h < d.rows(); h++) }
\DoxyCodeLine{417         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} k = 0; k < d.cols(); k++)}
\DoxyCodeLine{418           A(i*d.rows() + h, j * d.cols() + k) = B(i, j) * d(h, k);  }
\DoxyCodeLine{419 }
\DoxyCodeLine{420   \textcolor{keywordflow}{return} Eigen::Matrix<Scalar, -\/1, -\/1>(A);}
\DoxyCodeLine{421 \}}
\DoxyCodeLine{422 }
\DoxyCodeLine{423 \textcolor{keyword}{template} <\textcolor{keyword}{typename} Scalar>}
\DoxyCodeLine{424 std::vector<Eigen::Triplet<Scalar>> RayBenConvection::m\_SparseToTriplet(Eigen::SparseMatrix<Scalar> \&A)}
\DoxyCodeLine{425 \{}
\DoxyCodeLine{426   std::vector<Eigen::Triplet<Scalar>> A\_Triplet;}
\DoxyCodeLine{427   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} k = 0; k < A.outerSize(); ++k)}
\DoxyCodeLine{428   \{}
\DoxyCodeLine{429       \textcolor{keywordflow}{for} (Eigen::InnerIterator<Eigen::SparseMatrix<Scalar>> it(A, k); it; ++it)}
\DoxyCodeLine{430       \{}
\DoxyCodeLine{431           A\_Triplet.push\_back(Eigen::Triplet<Scalar>(it.row(), it.col(), it.value()));}
\DoxyCodeLine{432       \}}
\DoxyCodeLine{433   \}}
\DoxyCodeLine{434   \textcolor{keywordflow}{return} A\_Triplet;}
\DoxyCodeLine{435 \}}
\DoxyCodeLine{436 }
\DoxyCodeLine{437 \textcolor{keyword}{template} <\textcolor{keyword}{typename} Scalar>}
\DoxyCodeLine{438 Eigen::Matrix<int, 1, -\/1> RayBenConvection::m\_my\_symamd(Eigen::Matrix<Scalar, -\/1, -\/1> \&mat) \{}
\DoxyCodeLine{439   \textcolor{keywordflow}{if} (mat.rows() != mat.cols()) \{}
\DoxyCodeLine{440     std::cerr << \textcolor{stringliteral}{"{}symamd: Matrice non quadrata!"{}} << std::endl;}
\DoxyCodeLine{441     exit(1);}
\DoxyCodeLine{442   \}}
\DoxyCodeLine{443   Eigen::SparseMatrix<Scalar> spmat(mat.sparseView()); }
\DoxyCodeLine{444   \textcolor{keywordtype}{int} A[spmat.nonZeros()];}
\DoxyCodeLine{445   \textcolor{keywordtype}{int} p[mat.cols()+1];}
\DoxyCodeLine{446   \textcolor{keywordtype}{int} perm[mat.cols()+1];}
\DoxyCodeLine{447   \textcolor{keywordtype}{int} stats [COLAMD\_STATS];}
\DoxyCodeLine{448   \textcolor{keywordtype}{int} retcode;}
\DoxyCodeLine{449 }
\DoxyCodeLine{450   ::memset(A, 0, (spmat.nonZeros()) * \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{int}));}
\DoxyCodeLine{451   ::memset(p, 0, (mat.cols()+1) * \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{int}));}
\DoxyCodeLine{452   ::memset(perm, 0, (mat.cols()+1) * \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{int}));}
\DoxyCodeLine{453   ::memset(stats, 0, COLAMD\_STATS * \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{int}));}
\DoxyCodeLine{454 }
\DoxyCodeLine{455   \textcolor{keywordtype}{int} A\_i = 0, old\_A\_i = 0, p\_i = 1;}
\DoxyCodeLine{456   p[0] = 0;}
\DoxyCodeLine{457   \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i = 0; i < mat.cols(); ++i) \{}
\DoxyCodeLine{458     old\_A\_i = A\_i;}
\DoxyCodeLine{459     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} k = 0; k < mat.rows(); ++k) \{}
\DoxyCodeLine{460       \textcolor{keywordflow}{if}(mat(k,i) != 0) \{}
\DoxyCodeLine{461         A[A\_i] = k;}
\DoxyCodeLine{462         A\_i++;}
\DoxyCodeLine{463       \}}
\DoxyCodeLine{464     \}}
\DoxyCodeLine{465     \textcolor{keywordflow}{if}(old\_A\_i < A\_i)\{}
\DoxyCodeLine{466       p[p\_i] = A\_i;}
\DoxyCodeLine{467       p\_i++;}
\DoxyCodeLine{468     \}}
\DoxyCodeLine{469   \}}
\DoxyCodeLine{470   p[mat.cols()] = spmat.nonZeros();}
\DoxyCodeLine{471 }
\DoxyCodeLine{472   retcode = symamd(mat.cols(), A, p, perm, (\textcolor{keywordtype}{double} *) NULL, stats, \&calloc, \&free);}
\DoxyCodeLine{473 }
\DoxyCodeLine{474   \textcolor{keywordflow}{if}(retcode == 1)\{ }
\DoxyCodeLine{475     Eigen::Matrix<int, 1, -\/1> permMat;}
\DoxyCodeLine{476     permMat.resize(1, mat.cols());}
\DoxyCodeLine{477     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i = 0; i < mat.cols(); ++i)}
\DoxyCodeLine{478       permMat(0, i) = perm[i];}
\DoxyCodeLine{479     \textcolor{keywordflow}{return} permMat;}
\DoxyCodeLine{480   \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (retcode == 0) \{}
\DoxyCodeLine{481     std::cerr << \textcolor{stringliteral}{"{}symamd: something wrong..."{}} << std::endl;}
\DoxyCodeLine{482     \textcolor{keywordflow}{return} Eigen::Matrix<int,1,1>(0);}
\DoxyCodeLine{483   \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{484     std::cerr << \textcolor{stringliteral}{"{}symamd: something really wrong happened!"{}} << std::endl;}
\DoxyCodeLine{485     \textcolor{keywordflow}{return} Eigen::Matrix<int,1,1>(0);}
\DoxyCodeLine{486   \}}
\DoxyCodeLine{487 \}}
\DoxyCodeLine{488 }
\DoxyCodeLine{489 \textcolor{keywordtype}{void} RayBenConvection::m\_luP(Eigen::Matrix<double,-\/1,-\/1> \&mat,}
\DoxyCodeLine{490          std::vector<Eigen::Matrix<double,-\/1,-\/1>> \&ret\_vett)\{}
\DoxyCodeLine{491 }
\DoxyCodeLine{492   Eigen::SparseMatrix<double> spmat = mat.sparseView();}
\DoxyCodeLine{493   Eigen::PartialPivLU<Eigen::Matrix<double,-\/1,-\/1>> LU\_dec(spmat);}
\DoxyCodeLine{494 }
\DoxyCodeLine{495   Eigen::Matrix<double,-\/1,-\/1> LU\_mat(LU\_dec.matrixLU());}
\DoxyCodeLine{496   Eigen::Matrix<double,-\/1,-\/1> L\_mat = LU\_mat.triangularView<Eigen::UpLoType::UnitLower>();}
\DoxyCodeLine{497   Eigen::Matrix<double,-\/1,-\/1> U\_mat = LU\_mat.triangularView<Eigen::UpLoType::Upper>();}
\DoxyCodeLine{498   Eigen::Matrix<double,-\/1,-\/1> PL\_mat = LU\_dec.permutationP().transpose() * L\_mat;}
\DoxyCodeLine{499 }
\DoxyCodeLine{500   ret\_vett.clear();}
\DoxyCodeLine{501   ret\_vett.push\_back(PL\_mat); \textcolor{comment}{//[0]}}
\DoxyCodeLine{502   ret\_vett.push\_back(U\_mat); \textcolor{comment}{//[1]}}
\DoxyCodeLine{503 }
\DoxyCodeLine{504   \textcolor{keywordflow}{return};}
\DoxyCodeLine{505 \}}
\DoxyCodeLine{506 }
\DoxyCodeLine{507 \textcolor{keywordtype}{void} RayBenConvection::m\_write\_current\_frame ()\{}
\DoxyCodeLine{508   \mbox{\hyperlink{classRayBenConvection_a1efa7e03cd0d72a7901f47dd575bfdc5}{m\_output\_header\_file}} << \textcolor{stringliteral}{"{}\{"{}};}
\DoxyCodeLine{509     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i = 0; i < \mbox{\hyperlink{classRayBenConvection_aa2e29e985716895f8f19e3930078ec00}{m\_ny}}; i++) \{}
\DoxyCodeLine{510       \mbox{\hyperlink{classRayBenConvection_a1efa7e03cd0d72a7901f47dd575bfdc5}{m\_output\_header\_file}} << \textcolor{stringliteral}{"{}\{"{}};}
\DoxyCodeLine{511         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} j = 0; j < \mbox{\hyperlink{classRayBenConvection_a00ece8699bc4531e4dc5edfe2cfcfd7b}{m\_nx}}; j++)}
\DoxyCodeLine{512           \textcolor{keywordflow}{if} (j < \mbox{\hyperlink{classRayBenConvection_a00ece8699bc4531e4dc5edfe2cfcfd7b}{m\_nx}} -\/ 1)}
\DoxyCodeLine{513             \mbox{\hyperlink{classRayBenConvection_a1efa7e03cd0d72a7901f47dd575bfdc5}{m\_output\_header\_file}} << \textcolor{stringliteral}{"{}\(\backslash\)t"{}} << \mbox{\hyperlink{classRayBenConvection_aecfd1a81f7bc8e559a3d17237ebf227c}{m\_T}}(j, i) << \textcolor{stringliteral}{"{}, "{}};}
\DoxyCodeLine{514           \textcolor{keywordflow}{else} \mbox{\hyperlink{classRayBenConvection_a1efa7e03cd0d72a7901f47dd575bfdc5}{m\_output\_header\_file}} << \textcolor{stringliteral}{"{}\(\backslash\)t"{}} << \mbox{\hyperlink{classRayBenConvection_aecfd1a81f7bc8e559a3d17237ebf227c}{m\_T}}(j, i); }
\DoxyCodeLine{515       \mbox{\hyperlink{classRayBenConvection_a1efa7e03cd0d72a7901f47dd575bfdc5}{m\_output\_header\_file}} << \textcolor{stringliteral}{"{}\},\(\backslash\)n "{}};}
\DoxyCodeLine{516       \}}
\DoxyCodeLine{517   \mbox{\hyperlink{classRayBenConvection_a1efa7e03cd0d72a7901f47dd575bfdc5}{m\_output\_header\_file}} << \textcolor{stringliteral}{"{}\}"{}};}
\DoxyCodeLine{518 \};}
\DoxyCodeLine{519 }
\DoxyCodeLine{521 }
\DoxyCodeLine{532 \textcolor{keywordtype}{int} \mbox{\hyperlink{classRayBenConvection_af068a10b389817887e3f91bf9bff965a}{RayBenConvection::init}}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} END\_CICLE, \textcolor{keywordtype}{double} cold\_temp, \textcolor{keywordtype}{double} hot\_temp, }
\DoxyCodeLine{533                             \textcolor{keywordtype}{double} Ray\_numb, \textcolor{keywordtype}{double} Pr\_numb, \textcolor{keywordtype}{double} Re\_numb )\{}
\DoxyCodeLine{534 }
\DoxyCodeLine{535   std::cerr << \textcolor{stringliteral}{"{}INFO: RayBenConvection: init: Initializing simulation..."{}} << std::endl;}
\DoxyCodeLine{536   std::chrono::time\_point<std::chrono::high\_resolution\_clock> init\_lenght = }
\DoxyCodeLine{537     std::chrono::high\_resolution\_clock::now();}
\DoxyCodeLine{538   Eigen::setNbThreads(NPROC);}
\DoxyCodeLine{539 }
\DoxyCodeLine{540   \textcolor{keywordtype}{int} ret\_value = 0;}
\DoxyCodeLine{541   \mbox{\hyperlink{classRayBenConvection_a30361d2ad21ab61d60fb8bb21fba82de}{m\_END\_CICLE}} = END\_CICLE;}
\DoxyCodeLine{542   \mbox{\hyperlink{classRayBenConvection_a0fade52114cb600deba397e9c3d86b12}{m\_TN}} = cold\_temp;}
\DoxyCodeLine{543   \mbox{\hyperlink{classRayBenConvection_ac1331aa9a8a5f7b079af0df68bc3dcfc}{m\_TS}} = hot\_temp;}
\DoxyCodeLine{544   \mbox{\hyperlink{classRayBenConvection_a6eade7fabf66cfd00e19bdbc7f057341}{m\_Ra}} = Ray\_numb;}
\DoxyCodeLine{545   \mbox{\hyperlink{classRayBenConvection_af246c10dd8e2c4f9fe3951d74453e9e0}{m\_Pr}} = Pr\_numb;}
\DoxyCodeLine{546   \mbox{\hyperlink{classRayBenConvection_a9558a662a91ef2887302e7f8913654b9}{m\_Re}} = Re\_numb;}
\DoxyCodeLine{547   m\_Pe = \mbox{\hyperlink{classRayBenConvection_a9558a662a91ef2887302e7f8913654b9}{m\_Re}} * \mbox{\hyperlink{classRayBenConvection_af246c10dd8e2c4f9fe3951d74453e9e0}{m\_Pr}};}
\DoxyCodeLine{548   m\_Gr= \mbox{\hyperlink{classRayBenConvection_a6eade7fabf66cfd00e19bdbc7f057341}{m\_Ra}} / \mbox{\hyperlink{classRayBenConvection_af246c10dd8e2c4f9fe3951d74453e9e0}{m\_Pr}};}
\DoxyCodeLine{549 }
\DoxyCodeLine{550   \textcolor{keywordflow}{if} (END\_CICLE > 6000)\{}
\DoxyCodeLine{551     std::cerr << \textcolor{stringliteral}{"{}ERROR: RayBenConvection: init: The number of steps requested "{}}}
\DoxyCodeLine{552               << END\_CICLE << \textcolor{stringliteral}{"{} is too high."{}} << std::endl;}
\DoxyCodeLine{553     \textcolor{keywordflow}{return} -\/1;}
\DoxyCodeLine{554   \}}
\DoxyCodeLine{555 }
\DoxyCodeLine{556   \textcolor{keywordflow}{if}(\mbox{\hyperlink{classRayBenConvection_ac1331aa9a8a5f7b079af0df68bc3dcfc}{m\_TS}} != \mbox{\hyperlink{classRayBenConvection_a0fade52114cb600deba397e9c3d86b12}{m\_TN}})}
\DoxyCodeLine{557     \mbox{\hyperlink{classRayBenConvection_abfa7478fe1bf2a2744403d17ca248a3d}{m\_To}} = (\mbox{\hyperlink{classRayBenConvection_ac1331aa9a8a5f7b079af0df68bc3dcfc}{m\_TS}} < \mbox{\hyperlink{classRayBenConvection_a0fade52114cb600deba397e9c3d86b12}{m\_TN}}) ? \mbox{\hyperlink{classRayBenConvection_ac1331aa9a8a5f7b079af0df68bc3dcfc}{m\_TS}} : \mbox{\hyperlink{classRayBenConvection_a0fade52114cb600deba397e9c3d86b12}{m\_TN}};}
\DoxyCodeLine{558   \textcolor{keywordflow}{else}\{}
\DoxyCodeLine{559     std::cout << \textcolor{stringliteral}{"{}Please, remeber to provide two different temperatures."{}};}
\DoxyCodeLine{560     \textcolor{keywordflow}{return} -\/2;}
\DoxyCodeLine{561   \}}
\DoxyCodeLine{562 }
\DoxyCodeLine{563   \textcolor{keywordflow}{if} (m\_TN <= 0 || m\_TN >= 100)\{}
\DoxyCodeLine{564     std::cout << \textcolor{stringliteral}{"{}Default parameters regard liquid water. Work in 1-\/99 range."{}};}
\DoxyCodeLine{565     \textcolor{keywordflow}{return} -\/3;}
\DoxyCodeLine{566   \}}
\DoxyCodeLine{567 }
\DoxyCodeLine{568   \textcolor{keywordflow}{if} (\mbox{\hyperlink{classRayBenConvection_ac1331aa9a8a5f7b079af0df68bc3dcfc}{m\_TS}} >= 100)\{}
\DoxyCodeLine{569     std::cout << \textcolor{stringliteral}{"{}Default parameters regard liquid water. Work in 1-\/99 range."{}};}
\DoxyCodeLine{570     \textcolor{keywordflow}{return} -\/7;}
\DoxyCodeLine{571   \}}
\DoxyCodeLine{572 }
\DoxyCodeLine{573   \textcolor{keywordflow}{if} (Ray\_numb < 50 || Ray\_numb > 150 )\{}
\DoxyCodeLine{574     std::cout << \textcolor{stringliteral}{"{}Working range for Rayleigh number: 50-\/150."{}};}
\DoxyCodeLine{575     \textcolor{keywordflow}{return} -\/4;}
\DoxyCodeLine{576   \}}
\DoxyCodeLine{577 }
\DoxyCodeLine{578   \textcolor{keywordflow}{if} (Pr\_numb < 5 || Pr\_numb > 9)\{}
\DoxyCodeLine{579     std::cout << \textcolor{stringliteral}{"{}Working range for Prandtl number: 5-\/9."{}};}
\DoxyCodeLine{580     \textcolor{keywordflow}{return} -\/5;}
\DoxyCodeLine{581   \}}
\DoxyCodeLine{582 }
\DoxyCodeLine{583   \textcolor{keywordflow}{if} (Re\_numb < 70 ||  Re\_numb > 130)\{}
\DoxyCodeLine{584     std::cout << \textcolor{stringliteral}{"{}Working range for Reynolds number: 70-\/130."{}};}
\DoxyCodeLine{585     \textcolor{keywordflow}{return} -\/6;}
\DoxyCodeLine{586   \}}
\DoxyCodeLine{587 }
\DoxyCodeLine{588   \textcolor{keywordflow}{if} (\mbox{\hyperlink{classRayBenConvection_a0fade52114cb600deba397e9c3d86b12}{m\_TN}} < 4)\{}
\DoxyCodeLine{589     std::cout << \textcolor{stringliteral}{"{}Working with linear parameters. Liquid water "{}}}
\DoxyCodeLine{590                  \textcolor{stringliteral}{"{}below of 4 Celsius does not follow linear behaviour."{}} << std::endl;}
\DoxyCodeLine{591     std::cout << \textcolor{stringliteral}{"{}A simulation will be provided but the user is "{}}}
\DoxyCodeLine{592                  \textcolor{stringliteral}{"{}advised to change working parameters."{}} << std::endl;}
\DoxyCodeLine{593     ret\_value += 0b00010000000000000000000000000000;}
\DoxyCodeLine{594   \}}
\DoxyCodeLine{595 }
\DoxyCodeLine{596   \textcolor{keywordflow}{if} (\mbox{\hyperlink{classRayBenConvection_ac1331aa9a8a5f7b079af0df68bc3dcfc}{m\_TS}} -\/ \mbox{\hyperlink{classRayBenConvection_a0fade52114cb600deba397e9c3d86b12}{m\_TN}} > 10)\{}
\DoxyCodeLine{597     std::cout << \textcolor{stringliteral}{"{}Warning: with this temperature range the linear"{}} }
\DoxyCodeLine{598                 \textcolor{stringliteral}{"{} model validity is not guaranteed."{}} << std::endl;}
\DoxyCodeLine{599     std::cout << \textcolor{stringliteral}{"{}The duration of the simulation will depend on the temperature range,"{}} }
\DoxyCodeLine{600                  \textcolor{stringliteral}{"{}so nsteps requested cannot be assured."{}} << std::endl; }
\DoxyCodeLine{601     ret\_value += 0b00100000000000000000000000000000;}
\DoxyCodeLine{602   \}}
\DoxyCodeLine{603 }
\DoxyCodeLine{604   \textcolor{comment}{//m\_dt correction:}}
\DoxyCodeLine{605   \mbox{\hyperlink{classRayBenConvection_ae106f4c67cc111c54d23730e8e7fa7e6}{m\_dt}} = \mbox{\hyperlink{classRayBenConvection_a8b38201fb9bd541ccb0974df9d61c22c}{m\_tf}} / \mbox{\hyperlink{classRayBenConvection_a6a6f9567a98085c522e319da90d0b6c6}{m\_nt}};}
\DoxyCodeLine{606 }
\DoxyCodeLine{607   \textcolor{comment}{//initialising calculation maxtrices:}}
\DoxyCodeLine{608   \mbox{\hyperlink{classRayBenConvection_ac9933db8381584f9d732b85391da2533}{m\_u}}.setZero();}
\DoxyCodeLine{609   \mbox{\hyperlink{classRayBenConvection_af863193c10cffeaf20f749df0ec845a5}{m\_v}}.setZero();}
\DoxyCodeLine{610   \mbox{\hyperlink{classRayBenConvection_a66828b8a9611c0a5dac1eeb64d1fa614}{m\_p}}.setZero();}
\DoxyCodeLine{611   \mbox{\hyperlink{classRayBenConvection_a2bf183a03e99f6a9b2a6f4139f780ec3}{m\_S}}.setZero();}
\DoxyCodeLine{612   \mbox{\hyperlink{classRayBenConvection_aecfd1a81f7bc8e559a3d17237ebf227c}{m\_T}}.setConstant(\mbox{\hyperlink{classRayBenConvection_abfa7478fe1bf2a2744403d17ca248a3d}{m\_To}});}
\DoxyCodeLine{613 }
\DoxyCodeLine{614   \mbox{\hyperlink{classRayBenConvection_a0369de1dcfd6a9c4681a22ef77281bad}{m\_Tstar}} = \mbox{\hyperlink{classRayBenConvection_aecfd1a81f7bc8e559a3d17237ebf227c}{m\_T}};}
\DoxyCodeLine{615   \mbox{\hyperlink{classRayBenConvection_a22bceb43d4d9ba695f21bf1306a8f354}{m\_ustar}} = \mbox{\hyperlink{classRayBenConvection_ac9933db8381584f9d732b85391da2533}{m\_u}};}
\DoxyCodeLine{616   \mbox{\hyperlink{classRayBenConvection_ab1204d12009f19080daa8e48072854cd}{m\_uhalf}} = \mbox{\hyperlink{classRayBenConvection_ac9933db8381584f9d732b85391da2533}{m\_u}};}
\DoxyCodeLine{617   \mbox{\hyperlink{classRayBenConvection_a316a9e7f0c079b6fba771d7b15bd6647}{m\_uconv}} = \mbox{\hyperlink{classRayBenConvection_ac9933db8381584f9d732b85391da2533}{m\_u}};}
\DoxyCodeLine{618   \mbox{\hyperlink{classRayBenConvection_a8e8d1bec9c3fbd2876adc957f4ed767d}{m\_vstar}} = \mbox{\hyperlink{classRayBenConvection_af863193c10cffeaf20f749df0ec845a5}{m\_v}};}
\DoxyCodeLine{619   \mbox{\hyperlink{classRayBenConvection_aeada1a30f797e981b52d3b4e0640b198}{m\_vhalf}} = \mbox{\hyperlink{classRayBenConvection_af863193c10cffeaf20f749df0ec845a5}{m\_v}};}
\DoxyCodeLine{620   \mbox{\hyperlink{classRayBenConvection_a2e5088ea41b7faad0bcc9bfda83939ef}{m\_vconv}} = \mbox{\hyperlink{classRayBenConvection_af863193c10cffeaf20f749df0ec845a5}{m\_v}};}
\DoxyCodeLine{621 }
\DoxyCodeLine{622   \textcolor{comment}{//IMPLICIT DIFFUSION:-\/}}
\DoxyCodeLine{623   \textcolor{comment}{//B.C vector(for u)}}
\DoxyCodeLine{624   \mbox{\hyperlink{classRayBenConvection_ab25ed57d64bce95a1f0b385151be1a41}{m\_bcu}}.setZero(),}
\DoxyCodeLine{625   \mbox{\hyperlink{classRayBenConvection_ab25ed57d64bce95a1f0b385151be1a41}{m\_bcu}}.row(0).setConstant(2 * \mbox{\hyperlink{classRayBenConvection_a56534034d797d9099f53367d4828f0c7}{m\_UW}} / std::pow(\mbox{\hyperlink{classRayBenConvection_a2bb417e336a4ae74e517e2eba04d179d}{m\_dx}},2));}
\DoxyCodeLine{626   \mbox{\hyperlink{classRayBenConvection_ab25ed57d64bce95a1f0b385151be1a41}{m\_bcu}}.row(\mbox{\hyperlink{classRayBenConvection_ab25ed57d64bce95a1f0b385151be1a41}{m\_bcu}}.rows()-\/1).setConstant(2 * \mbox{\hyperlink{classRayBenConvection_ad3b4ec6a6500a9b9355c60d66a62091b}{m\_UE}} / std::pow(\mbox{\hyperlink{classRayBenConvection_a2bb417e336a4ae74e517e2eba04d179d}{m\_dx}},2));}
\DoxyCodeLine{627   \mbox{\hyperlink{classRayBenConvection_ab25ed57d64bce95a1f0b385151be1a41}{m\_bcu}}.col(0).setConstant(\mbox{\hyperlink{classRayBenConvection_a99f0d9ab29a2db33829175a790fa9bc7}{m\_US}} / std::pow(\mbox{\hyperlink{classRayBenConvection_a6d70b64b68c44a8b5f4ed5ca86dfcf71}{m\_dy}},2));}
\DoxyCodeLine{628   \mbox{\hyperlink{classRayBenConvection_ab25ed57d64bce95a1f0b385151be1a41}{m\_bcu}}.col(\mbox{\hyperlink{classRayBenConvection_ab25ed57d64bce95a1f0b385151be1a41}{m\_bcu}}.cols()-\/1).setConstant(\mbox{\hyperlink{classRayBenConvection_aab15fee9f0b6d470dd9d02d85439a7a8}{m\_UN}} / std::pow(\mbox{\hyperlink{classRayBenConvection_a6d70b64b68c44a8b5f4ed5ca86dfcf71}{m\_dy}},2));}
\DoxyCodeLine{629 }
\DoxyCodeLine{630   \textcolor{comment}{//B.Cs at the corners:}}
\DoxyCodeLine{631   \mbox{\hyperlink{classRayBenConvection_ab25ed57d64bce95a1f0b385151be1a41}{m\_bcu}}(0, 0)                       = 2 * \mbox{\hyperlink{classRayBenConvection_a56534034d797d9099f53367d4828f0c7}{m\_UW}} / std::pow(\mbox{\hyperlink{classRayBenConvection_a2bb417e336a4ae74e517e2eba04d179d}{m\_dx}},2) + \mbox{\hyperlink{classRayBenConvection_a99f0d9ab29a2db33829175a790fa9bc7}{m\_US}} / std::pow(\mbox{\hyperlink{classRayBenConvection_a6d70b64b68c44a8b5f4ed5ca86dfcf71}{m\_dy}},2);}
\DoxyCodeLine{632   \mbox{\hyperlink{classRayBenConvection_ab25ed57d64bce95a1f0b385151be1a41}{m\_bcu}}(\mbox{\hyperlink{classRayBenConvection_ab25ed57d64bce95a1f0b385151be1a41}{m\_bcu}}.rows()-\/1, 0)            = 2 * \mbox{\hyperlink{classRayBenConvection_ad3b4ec6a6500a9b9355c60d66a62091b}{m\_UE}} / std::pow(\mbox{\hyperlink{classRayBenConvection_a2bb417e336a4ae74e517e2eba04d179d}{m\_dx}},2) + \mbox{\hyperlink{classRayBenConvection_a99f0d9ab29a2db33829175a790fa9bc7}{m\_US}} / std::pow(\mbox{\hyperlink{classRayBenConvection_a6d70b64b68c44a8b5f4ed5ca86dfcf71}{m\_dy}},2);}
\DoxyCodeLine{633   \mbox{\hyperlink{classRayBenConvection_ab25ed57d64bce95a1f0b385151be1a41}{m\_bcu}}(0, (\mbox{\hyperlink{classRayBenConvection_aa2e29e985716895f8f19e3930078ec00}{m\_ny}}-\/2)-\/1)                = 2 * \mbox{\hyperlink{classRayBenConvection_a56534034d797d9099f53367d4828f0c7}{m\_UW}} / std::pow(\mbox{\hyperlink{classRayBenConvection_a2bb417e336a4ae74e517e2eba04d179d}{m\_dx}},2) + \mbox{\hyperlink{classRayBenConvection_aab15fee9f0b6d470dd9d02d85439a7a8}{m\_UN}} / std::pow(\mbox{\hyperlink{classRayBenConvection_a6d70b64b68c44a8b5f4ed5ca86dfcf71}{m\_dy}},2);}
\DoxyCodeLine{634   \mbox{\hyperlink{classRayBenConvection_ab25ed57d64bce95a1f0b385151be1a41}{m\_bcu}}(\mbox{\hyperlink{classRayBenConvection_ab25ed57d64bce95a1f0b385151be1a41}{m\_bcu}}.rows()-\/1, \mbox{\hyperlink{classRayBenConvection_ab25ed57d64bce95a1f0b385151be1a41}{m\_bcu}}.cols()-\/1) = 2 * \mbox{\hyperlink{classRayBenConvection_ad3b4ec6a6500a9b9355c60d66a62091b}{m\_UE}} / std::pow(\mbox{\hyperlink{classRayBenConvection_a2bb417e336a4ae74e517e2eba04d179d}{m\_dx}},2) + \mbox{\hyperlink{classRayBenConvection_aab15fee9f0b6d470dd9d02d85439a7a8}{m\_UN}} / std::pow(\mbox{\hyperlink{classRayBenConvection_a6d70b64b68c44a8b5f4ed5ca86dfcf71}{m\_dy}},2);}
\DoxyCodeLine{635   \mbox{\hyperlink{classRayBenConvection_ab25ed57d64bce95a1f0b385151be1a41}{m\_bcu}} = \mbox{\hyperlink{classRayBenConvection_ae106f4c67cc111c54d23730e8e7fa7e6}{m\_dt}} * \mbox{\hyperlink{classRayBenConvection_ab25ed57d64bce95a1f0b385151be1a41}{m\_bcu}} / \mbox{\hyperlink{classRayBenConvection_a9558a662a91ef2887302e7f8913654b9}{m\_Re}};}
\DoxyCodeLine{636 }
\DoxyCodeLine{637   \textcolor{comment}{//B.C vector(for v)}}
\DoxyCodeLine{638   \mbox{\hyperlink{classRayBenConvection_ae8a99eaf006353101cd1cb4cd6803da4}{m\_bcv}}.setZero();}
\DoxyCodeLine{639   \mbox{\hyperlink{classRayBenConvection_ae8a99eaf006353101cd1cb4cd6803da4}{m\_bcv}}.row(0).setConstant(2 * \mbox{\hyperlink{classRayBenConvection_aee29299c3f2cf435a3d179d4dcd9b0a1}{m\_VW}} / std::pow(\mbox{\hyperlink{classRayBenConvection_a2bb417e336a4ae74e517e2eba04d179d}{m\_dx}},2));}
\DoxyCodeLine{640   \mbox{\hyperlink{classRayBenConvection_ae8a99eaf006353101cd1cb4cd6803da4}{m\_bcv}}.row(\mbox{\hyperlink{classRayBenConvection_ae8a99eaf006353101cd1cb4cd6803da4}{m\_bcv}}.rows()-\/1).setConstant(2 * \mbox{\hyperlink{classRayBenConvection_abfccbde057005c07f8ee2b76ef68e4f7}{m\_VE}} / std::pow(\mbox{\hyperlink{classRayBenConvection_a2bb417e336a4ae74e517e2eba04d179d}{m\_dx}},2));}
\DoxyCodeLine{641   \mbox{\hyperlink{classRayBenConvection_ae8a99eaf006353101cd1cb4cd6803da4}{m\_bcv}}.col(0).setConstant(\mbox{\hyperlink{classRayBenConvection_afc0d1ada59367f173257a20e2cea845b}{m\_VS}} / std::pow(\mbox{\hyperlink{classRayBenConvection_a6d70b64b68c44a8b5f4ed5ca86dfcf71}{m\_dy}},2)); }
\DoxyCodeLine{642   \mbox{\hyperlink{classRayBenConvection_ae8a99eaf006353101cd1cb4cd6803da4}{m\_bcv}}.col(\mbox{\hyperlink{classRayBenConvection_ae8a99eaf006353101cd1cb4cd6803da4}{m\_bcv}}.cols()-\/1).setConstant(\mbox{\hyperlink{classRayBenConvection_ace7b32dda44cace25edfe8e481601733}{m\_VN}} / std::pow(\mbox{\hyperlink{classRayBenConvection_a6d70b64b68c44a8b5f4ed5ca86dfcf71}{m\_dy}},2));}
\DoxyCodeLine{643   }
\DoxyCodeLine{644   \textcolor{comment}{//B.Cs at the corners:}}
\DoxyCodeLine{645   \mbox{\hyperlink{classRayBenConvection_ae8a99eaf006353101cd1cb4cd6803da4}{m\_bcv}}(0, 0)                       = 2 * \mbox{\hyperlink{classRayBenConvection_aee29299c3f2cf435a3d179d4dcd9b0a1}{m\_VW}} / std::pow(\mbox{\hyperlink{classRayBenConvection_a2bb417e336a4ae74e517e2eba04d179d}{m\_dx}},2) + \mbox{\hyperlink{classRayBenConvection_afc0d1ada59367f173257a20e2cea845b}{m\_VS}} / std::pow(\mbox{\hyperlink{classRayBenConvection_a6d70b64b68c44a8b5f4ed5ca86dfcf71}{m\_dy}},2);}
\DoxyCodeLine{646   \mbox{\hyperlink{classRayBenConvection_ae8a99eaf006353101cd1cb4cd6803da4}{m\_bcv}}(\mbox{\hyperlink{classRayBenConvection_ae8a99eaf006353101cd1cb4cd6803da4}{m\_bcv}}.rows()-\/1, 0)            = 2 * \mbox{\hyperlink{classRayBenConvection_abfccbde057005c07f8ee2b76ef68e4f7}{m\_VE}} / std::pow(\mbox{\hyperlink{classRayBenConvection_a2bb417e336a4ae74e517e2eba04d179d}{m\_dx}},2) + \mbox{\hyperlink{classRayBenConvection_afc0d1ada59367f173257a20e2cea845b}{m\_VS}} / std::pow(\mbox{\hyperlink{classRayBenConvection_a6d70b64b68c44a8b5f4ed5ca86dfcf71}{m\_dy}},2);}
\DoxyCodeLine{647   \mbox{\hyperlink{classRayBenConvection_ae8a99eaf006353101cd1cb4cd6803da4}{m\_bcv}}(0, \mbox{\hyperlink{classRayBenConvection_ae8a99eaf006353101cd1cb4cd6803da4}{m\_bcv}}.cols()-\/1)            = 2 * \mbox{\hyperlink{classRayBenConvection_aee29299c3f2cf435a3d179d4dcd9b0a1}{m\_VW}} / std::pow(\mbox{\hyperlink{classRayBenConvection_a2bb417e336a4ae74e517e2eba04d179d}{m\_dx}},2) + \mbox{\hyperlink{classRayBenConvection_ace7b32dda44cace25edfe8e481601733}{m\_VN}} / std::pow(\mbox{\hyperlink{classRayBenConvection_a6d70b64b68c44a8b5f4ed5ca86dfcf71}{m\_dy}},2);}
\DoxyCodeLine{648   \mbox{\hyperlink{classRayBenConvection_ae8a99eaf006353101cd1cb4cd6803da4}{m\_bcv}}(\mbox{\hyperlink{classRayBenConvection_ae8a99eaf006353101cd1cb4cd6803da4}{m\_bcv}}.rows()-\/1, \mbox{\hyperlink{classRayBenConvection_ae8a99eaf006353101cd1cb4cd6803da4}{m\_bcv}}.cols()-\/1) = 2 * \mbox{\hyperlink{classRayBenConvection_abfccbde057005c07f8ee2b76ef68e4f7}{m\_VE}} / std::pow(\mbox{\hyperlink{classRayBenConvection_a2bb417e336a4ae74e517e2eba04d179d}{m\_dx}},2) + \mbox{\hyperlink{classRayBenConvection_ace7b32dda44cace25edfe8e481601733}{m\_VN}} / std::pow(\mbox{\hyperlink{classRayBenConvection_a6d70b64b68c44a8b5f4ed5ca86dfcf71}{m\_dy}},2);}
\DoxyCodeLine{649   \mbox{\hyperlink{classRayBenConvection_ae8a99eaf006353101cd1cb4cd6803da4}{m\_bcv}} = \mbox{\hyperlink{classRayBenConvection_ae106f4c67cc111c54d23730e8e7fa7e6}{m\_dt}} * \mbox{\hyperlink{classRayBenConvection_ae8a99eaf006353101cd1cb4cd6803da4}{m\_bcv}} / \mbox{\hyperlink{classRayBenConvection_a9558a662a91ef2887302e7f8913654b9}{m\_Re}};}
\DoxyCodeLine{650 }
\DoxyCodeLine{651   \textcolor{comment}{//Initialising central difference operator(for u)}}
\DoxyCodeLine{652   \mbox{\hyperlink{classRayBenConvection_abbc6bb7a871ccde05c4b5a9519eb7cd8}{m\_e}}.resize(\mbox{\hyperlink{classRayBenConvection_a00ece8699bc4531e4dc5edfe2cfcfd7b}{m\_nx}}-\/1, 1);}
\DoxyCodeLine{653   \mbox{\hyperlink{classRayBenConvection_ada01bc16d6b738fef671eb8c21461d40}{m\_i}}.resize(\mbox{\hyperlink{classRayBenConvection_aa2e29e985716895f8f19e3930078ec00}{m\_ny}}-\/2, 1);}
\DoxyCodeLine{654   \mbox{\hyperlink{classRayBenConvection_abbc6bb7a871ccde05c4b5a9519eb7cd8}{m\_e}}.setOnes();}
\DoxyCodeLine{655   \mbox{\hyperlink{classRayBenConvection_ada01bc16d6b738fef671eb8c21461d40}{m\_i}}.setOnes();}
\DoxyCodeLine{656 }
\DoxyCodeLine{657   \mbox{\hyperlink{classRayBenConvection_a355433f2d50e67c93b922803b52afcb6}{m\_Ax}} = m\_spdiags(}
\DoxyCodeLine{658     \textcolor{keyword}{static\_cast<}Eigen::Matrix<\textcolor{keywordtype}{double}, -\/1, -\/1\textcolor{keyword}{>}>(\mbox{\hyperlink{classRayBenConvection_abbc6bb7a871ccde05c4b5a9519eb7cd8}{m\_e}} * Eigen::Matrix<double, 1, 3>(1, -\/2, 1)),}
\DoxyCodeLine{659     Eigen::Matrix<int, 1, 3> (-\/1, 0, 1), }
\DoxyCodeLine{660     \mbox{\hyperlink{classRayBenConvection_a00ece8699bc4531e4dc5edfe2cfcfd7b}{m\_nx}}-\/1, \mbox{\hyperlink{classRayBenConvection_a00ece8699bc4531e4dc5edfe2cfcfd7b}{m\_nx}}-\/1}
\DoxyCodeLine{661     );}
\DoxyCodeLine{662 }
\DoxyCodeLine{663   \mbox{\hyperlink{classRayBenConvection_a87b2a19b366009db54a377461aaf2768}{m\_Ay}} = m\_spdiags(}
\DoxyCodeLine{664     \textcolor{keyword}{static\_cast<}Eigen::Matrix<\textcolor{keywordtype}{double}, -\/1, -\/1\textcolor{keyword}{>}>(\mbox{\hyperlink{classRayBenConvection_ada01bc16d6b738fef671eb8c21461d40}{m\_i}} * Eigen::Matrix<double, 1, 3>(1, -\/2, 1)),}
\DoxyCodeLine{665     Eigen::Matrix<int, 1, 3> (-\/1, 0, 1), }
\DoxyCodeLine{666     \mbox{\hyperlink{classRayBenConvection_aa2e29e985716895f8f19e3930078ec00}{m\_ny}}-\/2, \mbox{\hyperlink{classRayBenConvection_aa2e29e985716895f8f19e3930078ec00}{m\_ny}}-\/2}
\DoxyCodeLine{667     );}
\DoxyCodeLine{668   }
\DoxyCodeLine{669   \mbox{\hyperlink{classRayBenConvection_a355433f2d50e67c93b922803b52afcb6}{m\_Ax}}(0, 0) = -\/3;}
\DoxyCodeLine{670   \mbox{\hyperlink{classRayBenConvection_a355433f2d50e67c93b922803b52afcb6}{m\_Ax}}(\mbox{\hyperlink{classRayBenConvection_a355433f2d50e67c93b922803b52afcb6}{m\_Ax}}.rows()-\/1, \mbox{\hyperlink{classRayBenConvection_a355433f2d50e67c93b922803b52afcb6}{m\_Ax}}.rows()-\/1) = -\/3; }
\DoxyCodeLine{671    }
\DoxyCodeLine{672   \mbox{\hyperlink{classRayBenConvection_a279afbe74b425c0a05bdcc3f854ebe79}{m\_A}} = m\_kron<double>(}
\DoxyCodeLine{673         \textcolor{keyword}{static\_cast<}Eigen::Matrix<\textcolor{keywordtype}{double}, -\/1, -\/1\textcolor{keyword}{>}>(\mbox{\hyperlink{classRayBenConvection_a87b2a19b366009db54a377461aaf2768}{m\_Ay}}/std::pow(\mbox{\hyperlink{classRayBenConvection_a6d70b64b68c44a8b5f4ed5ca86dfcf71}{m\_dy}},2)), }
\DoxyCodeLine{674         Eigen::Matrix<double, m\_nx-\/1, m\_nx-\/1>::Identity()}
\DoxyCodeLine{675         )}
\DoxyCodeLine{676         + m\_kron<double>(}
\DoxyCodeLine{677         Eigen::Matrix<double, m\_ny-\/2, m\_ny-\/2>::Identity(),}
\DoxyCodeLine{678         \textcolor{keyword}{static\_cast<}Eigen::Matrix<\textcolor{keywordtype}{double}, -\/1, -\/1\textcolor{keyword}{>}>(\mbox{\hyperlink{classRayBenConvection_a355433f2d50e67c93b922803b52afcb6}{m\_Ax}}/std::pow(\mbox{\hyperlink{classRayBenConvection_a2bb417e336a4ae74e517e2eba04d179d}{m\_dx}},2))}
\DoxyCodeLine{679         );}
\DoxyCodeLine{680   }
\DoxyCodeLine{681   \mbox{\hyperlink{classRayBenConvection_aa94ce938fcecf4c51febe3c19efca332}{m\_Du}} = Eigen::Matrix<double, (\mbox{\hyperlink{classRayBenConvection_a00ece8699bc4531e4dc5edfe2cfcfd7b}{m\_nx}}-\/1)*(\mbox{\hyperlink{classRayBenConvection_aa2e29e985716895f8f19e3930078ec00}{m\_ny}}-\/2), (\mbox{\hyperlink{classRayBenConvection_a00ece8699bc4531e4dc5edfe2cfcfd7b}{m\_nx}}-\/1)*(\mbox{\hyperlink{classRayBenConvection_aa2e29e985716895f8f19e3930078ec00}{m\_ny}}-\/2)>::Identity() -\/ \mbox{\hyperlink{classRayBenConvection_ae106f4c67cc111c54d23730e8e7fa7e6}{m\_dt}} * \mbox{\hyperlink{classRayBenConvection_a279afbe74b425c0a05bdcc3f854ebe79}{m\_A}}/\mbox{\hyperlink{classRayBenConvection_a9558a662a91ef2887302e7f8913654b9}{m\_Re}};}
\DoxyCodeLine{682   \mbox{\hyperlink{classRayBenConvection_ae3f0ffb3cfe0c04d2ad97caa1b66657d}{m\_pu}} = m\_my\_symamd(\mbox{\hyperlink{classRayBenConvection_aa94ce938fcecf4c51febe3c19efca332}{m\_Du}});}
\DoxyCodeLine{683   }
\DoxyCodeLine{684   \mbox{\hyperlink{classRayBenConvection_afc73f1c4923484d2891bb9a9b48620bb}{m\_Duperm}} = \mbox{\hyperlink{classRayBenConvection_aa94ce938fcecf4c51febe3c19efca332}{m\_Du}}(\mbox{\hyperlink{classRayBenConvection_ae3f0ffb3cfe0c04d2ad97caa1b66657d}{m\_pu}},\mbox{\hyperlink{classRayBenConvection_ae3f0ffb3cfe0c04d2ad97caa1b66657d}{m\_pu}});}
\DoxyCodeLine{685   }
\DoxyCodeLine{686   m\_luP(\mbox{\hyperlink{classRayBenConvection_afc73f1c4923484d2891bb9a9b48620bb}{m\_Duperm}}, \mbox{\hyperlink{classRayBenConvection_a2c0c7f84f7a1a702878f9980a4772bc0}{m\_LUu}});}
\DoxyCodeLine{687   }
\DoxyCodeLine{688   \textcolor{comment}{//Central difference operator(for v)}}
\DoxyCodeLine{689   \mbox{\hyperlink{classRayBenConvection_abbc6bb7a871ccde05c4b5a9519eb7cd8}{m\_e}}.resize(\mbox{\hyperlink{classRayBenConvection_a00ece8699bc4531e4dc5edfe2cfcfd7b}{m\_nx}}-\/2, 1);}
\DoxyCodeLine{690   \mbox{\hyperlink{classRayBenConvection_abbc6bb7a871ccde05c4b5a9519eb7cd8}{m\_e}}.setOnes();}
\DoxyCodeLine{691   \mbox{\hyperlink{classRayBenConvection_ada01bc16d6b738fef671eb8c21461d40}{m\_i}}.resize(\mbox{\hyperlink{classRayBenConvection_aa2e29e985716895f8f19e3930078ec00}{m\_ny}}-\/1, 1);}
\DoxyCodeLine{692   \mbox{\hyperlink{classRayBenConvection_ada01bc16d6b738fef671eb8c21461d40}{m\_i}}.setOnes();}
\DoxyCodeLine{693   }
\DoxyCodeLine{694   \mbox{\hyperlink{classRayBenConvection_a355433f2d50e67c93b922803b52afcb6}{m\_Ax}} = m\_spdiags(}
\DoxyCodeLine{695     \textcolor{keyword}{static\_cast<}Eigen::Matrix<\textcolor{keywordtype}{double}, -\/1, -\/1\textcolor{keyword}{>}>(\mbox{\hyperlink{classRayBenConvection_abbc6bb7a871ccde05c4b5a9519eb7cd8}{m\_e}} * Eigen::Matrix<double, 1, 3>(1, -\/2, 1)),}
\DoxyCodeLine{696     Eigen::Matrix<int, 1, 3> (-\/1, 0, 1), }
\DoxyCodeLine{697     \mbox{\hyperlink{classRayBenConvection_a00ece8699bc4531e4dc5edfe2cfcfd7b}{m\_nx}}-\/2, \mbox{\hyperlink{classRayBenConvection_a00ece8699bc4531e4dc5edfe2cfcfd7b}{m\_nx}}-\/2}
\DoxyCodeLine{698     );}
\DoxyCodeLine{699   }
\DoxyCodeLine{700   \mbox{\hyperlink{classRayBenConvection_a87b2a19b366009db54a377461aaf2768}{m\_Ay}} = m\_spdiags(}
\DoxyCodeLine{701     \textcolor{keyword}{static\_cast<}Eigen::Matrix<\textcolor{keywordtype}{double}, -\/1, -\/1\textcolor{keyword}{>}>(\mbox{\hyperlink{classRayBenConvection_ada01bc16d6b738fef671eb8c21461d40}{m\_i}} * Eigen::Matrix<double, 1, 3>(1, -\/2, 1)),}
\DoxyCodeLine{702     Eigen::Matrix<int, 1, 3> (-\/1, 0, 1), }
\DoxyCodeLine{703     \mbox{\hyperlink{classRayBenConvection_aa2e29e985716895f8f19e3930078ec00}{m\_ny}}-\/1, \mbox{\hyperlink{classRayBenConvection_aa2e29e985716895f8f19e3930078ec00}{m\_ny}}-\/1}
\DoxyCodeLine{704     ); }
\DoxyCodeLine{705   }
\DoxyCodeLine{706   \mbox{\hyperlink{classRayBenConvection_a87b2a19b366009db54a377461aaf2768}{m\_Ay}}(0, 0) = -\/3;}
\DoxyCodeLine{707   \mbox{\hyperlink{classRayBenConvection_a87b2a19b366009db54a377461aaf2768}{m\_Ay}}(\mbox{\hyperlink{classRayBenConvection_a87b2a19b366009db54a377461aaf2768}{m\_Ay}}.rows()-\/1, \mbox{\hyperlink{classRayBenConvection_a87b2a19b366009db54a377461aaf2768}{m\_Ay}}.cols()-\/1) = -\/3; }
\DoxyCodeLine{708    }
\DoxyCodeLine{709   \mbox{\hyperlink{classRayBenConvection_a279afbe74b425c0a05bdcc3f854ebe79}{m\_A}} = m\_kron<double>(}
\DoxyCodeLine{710         \textcolor{keyword}{static\_cast<}Eigen::Matrix<\textcolor{keywordtype}{double}, -\/1, -\/1\textcolor{keyword}{>}>(\mbox{\hyperlink{classRayBenConvection_a87b2a19b366009db54a377461aaf2768}{m\_Ay}}/std::pow(\mbox{\hyperlink{classRayBenConvection_a6d70b64b68c44a8b5f4ed5ca86dfcf71}{m\_dy}},2)), }
\DoxyCodeLine{711         Eigen::Matrix<double, m\_nx-\/2, m\_nx-\/2>::Identity()}
\DoxyCodeLine{712       )}
\DoxyCodeLine{713     + m\_kron<double>(}
\DoxyCodeLine{714         Eigen::Matrix<double, m\_ny-\/1, m\_ny-\/1>::Identity(),}
\DoxyCodeLine{715         \textcolor{keyword}{static\_cast<}Eigen::Matrix<\textcolor{keywordtype}{double}, -\/1, -\/1\textcolor{keyword}{>}>(\mbox{\hyperlink{classRayBenConvection_a355433f2d50e67c93b922803b52afcb6}{m\_Ax}}/std::pow(\mbox{\hyperlink{classRayBenConvection_a2bb417e336a4ae74e517e2eba04d179d}{m\_dx}},2))}
\DoxyCodeLine{716       );}
\DoxyCodeLine{717 }
\DoxyCodeLine{718   \mbox{\hyperlink{classRayBenConvection_a750b160d5cfc7fd029936245e9b2ba76}{m\_Dv}} = Eigen::Matrix<double, (\mbox{\hyperlink{classRayBenConvection_a00ece8699bc4531e4dc5edfe2cfcfd7b}{m\_nx}}-\/2)*(\mbox{\hyperlink{classRayBenConvection_aa2e29e985716895f8f19e3930078ec00}{m\_ny}}-\/1), (\mbox{\hyperlink{classRayBenConvection_a00ece8699bc4531e4dc5edfe2cfcfd7b}{m\_nx}}-\/2)*(\mbox{\hyperlink{classRayBenConvection_aa2e29e985716895f8f19e3930078ec00}{m\_ny}}-\/1)>::Identity() -\/ \mbox{\hyperlink{classRayBenConvection_ae106f4c67cc111c54d23730e8e7fa7e6}{m\_dt}} * \mbox{\hyperlink{classRayBenConvection_a279afbe74b425c0a05bdcc3f854ebe79}{m\_A}}/\mbox{\hyperlink{classRayBenConvection_a9558a662a91ef2887302e7f8913654b9}{m\_Re}};}
\DoxyCodeLine{719   \mbox{\hyperlink{classRayBenConvection_aa052588ce5527b7315207f19504843c5}{m\_pv}} = m\_my\_symamd(\mbox{\hyperlink{classRayBenConvection_a750b160d5cfc7fd029936245e9b2ba76}{m\_Dv}});}
\DoxyCodeLine{720 }
\DoxyCodeLine{721   \mbox{\hyperlink{classRayBenConvection_a566fcdb354ab8ab44549aa1698e69ea3}{m\_Dvperm}} = \mbox{\hyperlink{classRayBenConvection_a750b160d5cfc7fd029936245e9b2ba76}{m\_Dv}}(\mbox{\hyperlink{classRayBenConvection_aa052588ce5527b7315207f19504843c5}{m\_pv}},\mbox{\hyperlink{classRayBenConvection_aa052588ce5527b7315207f19504843c5}{m\_pv}});}
\DoxyCodeLine{722 }
\DoxyCodeLine{723   m\_luP(\mbox{\hyperlink{classRayBenConvection_a566fcdb354ab8ab44549aa1698e69ea3}{m\_Dvperm}}, m\_LUv);}
\DoxyCodeLine{724 }
\DoxyCodeLine{725   \textcolor{comment}{//}}
\DoxyCodeLine{726   \textcolor{comment}{//Calculating the coefficient matrix for the PPE}}
\DoxyCodeLine{727   \mbox{\hyperlink{classRayBenConvection_abbc6bb7a871ccde05c4b5a9519eb7cd8}{m\_e}}.resize(\mbox{\hyperlink{classRayBenConvection_a00ece8699bc4531e4dc5edfe2cfcfd7b}{m\_nx}}-\/2, 1);}
\DoxyCodeLine{728   \mbox{\hyperlink{classRayBenConvection_abbc6bb7a871ccde05c4b5a9519eb7cd8}{m\_e}}.setOnes();}
\DoxyCodeLine{729   \mbox{\hyperlink{classRayBenConvection_ada01bc16d6b738fef671eb8c21461d40}{m\_i}}.resize(\mbox{\hyperlink{classRayBenConvection_aa2e29e985716895f8f19e3930078ec00}{m\_ny}}-\/2, 1);}
\DoxyCodeLine{730   \mbox{\hyperlink{classRayBenConvection_ada01bc16d6b738fef671eb8c21461d40}{m\_i}}.setOnes();}
\DoxyCodeLine{731 }
\DoxyCodeLine{732   \mbox{\hyperlink{classRayBenConvection_a355433f2d50e67c93b922803b52afcb6}{m\_Ax}} = m\_spdiags(}
\DoxyCodeLine{733     \textcolor{keyword}{static\_cast<}Eigen::Matrix<\textcolor{keywordtype}{double}, -\/1, -\/1\textcolor{keyword}{>}>(\mbox{\hyperlink{classRayBenConvection_abbc6bb7a871ccde05c4b5a9519eb7cd8}{m\_e}} * Eigen::Matrix<double, 1, 3>(1, -\/2, 1)),}
\DoxyCodeLine{734     Eigen::Matrix<int, 1, 3> (-\/1, 0, 1), }
\DoxyCodeLine{735     \mbox{\hyperlink{classRayBenConvection_a00ece8699bc4531e4dc5edfe2cfcfd7b}{m\_nx}}-\/2, \mbox{\hyperlink{classRayBenConvection_a00ece8699bc4531e4dc5edfe2cfcfd7b}{m\_nx}}-\/2}
\DoxyCodeLine{736     ); }
\DoxyCodeLine{737 }
\DoxyCodeLine{738   \mbox{\hyperlink{classRayBenConvection_a87b2a19b366009db54a377461aaf2768}{m\_Ay}} = m\_spdiags(}
\DoxyCodeLine{739     \textcolor{keyword}{static\_cast<}Eigen::Matrix<\textcolor{keywordtype}{double}, -\/1, -\/1\textcolor{keyword}{>}>(\mbox{\hyperlink{classRayBenConvection_ada01bc16d6b738fef671eb8c21461d40}{m\_i}} * Eigen::Matrix<double, 1, 3>(1, -\/2, 1)),}
\DoxyCodeLine{740     Eigen::Matrix<int, 1, 3> (-\/1, 0, 1), }
\DoxyCodeLine{741     \mbox{\hyperlink{classRayBenConvection_aa2e29e985716895f8f19e3930078ec00}{m\_ny}}-\/2, \mbox{\hyperlink{classRayBenConvection_aa2e29e985716895f8f19e3930078ec00}{m\_ny}}-\/2}
\DoxyCodeLine{742     ); }
\DoxyCodeLine{743   }
\DoxyCodeLine{744   \mbox{\hyperlink{classRayBenConvection_a355433f2d50e67c93b922803b52afcb6}{m\_Ax}}(0, 0) = -\/1;}
\DoxyCodeLine{745   \mbox{\hyperlink{classRayBenConvection_a87b2a19b366009db54a377461aaf2768}{m\_Ay}}(0, 0) = -\/1;}
\DoxyCodeLine{746   \mbox{\hyperlink{classRayBenConvection_a355433f2d50e67c93b922803b52afcb6}{m\_Ax}}(\mbox{\hyperlink{classRayBenConvection_a355433f2d50e67c93b922803b52afcb6}{m\_Ax}}.rows()-\/1, \mbox{\hyperlink{classRayBenConvection_a355433f2d50e67c93b922803b52afcb6}{m\_Ax}}.cols()-\/1) = -\/1;}
\DoxyCodeLine{747   \mbox{\hyperlink{classRayBenConvection_a87b2a19b366009db54a377461aaf2768}{m\_Ay}}(\mbox{\hyperlink{classRayBenConvection_a87b2a19b366009db54a377461aaf2768}{m\_Ay}}.rows()-\/1, \mbox{\hyperlink{classRayBenConvection_a87b2a19b366009db54a377461aaf2768}{m\_Ay}}.cols()-\/1) = -\/1;}
\DoxyCodeLine{748 }
\DoxyCodeLine{749 }
\DoxyCodeLine{750   \mbox{\hyperlink{classRayBenConvection_a279afbe74b425c0a05bdcc3f854ebe79}{m\_A}} = m\_kron<double>(}
\DoxyCodeLine{751         \textcolor{keyword}{static\_cast<}Eigen::Matrix<\textcolor{keywordtype}{double}, -\/1, -\/1\textcolor{keyword}{>}>(\mbox{\hyperlink{classRayBenConvection_a87b2a19b366009db54a377461aaf2768}{m\_Ay}}/std::pow(\mbox{\hyperlink{classRayBenConvection_a6d70b64b68c44a8b5f4ed5ca86dfcf71}{m\_dy}},2)), }
\DoxyCodeLine{752         Eigen::Matrix<double, m\_nx-\/2, m\_nx-\/2>::Identity()}
\DoxyCodeLine{753       )}
\DoxyCodeLine{754     + m\_kron<double>(}
\DoxyCodeLine{755         Eigen::Matrix<double, m\_ny-\/2, m\_ny-\/2>::Identity(),}
\DoxyCodeLine{756         \textcolor{keyword}{static\_cast<}Eigen::Matrix<\textcolor{keywordtype}{double}, -\/1, -\/1\textcolor{keyword}{>}>(\mbox{\hyperlink{classRayBenConvection_a355433f2d50e67c93b922803b52afcb6}{m\_Ax}}/std::pow(\mbox{\hyperlink{classRayBenConvection_a2bb417e336a4ae74e517e2eba04d179d}{m\_dx}},2))}
\DoxyCodeLine{757       );}
\DoxyCodeLine{758 }
\DoxyCodeLine{759   \mbox{\hyperlink{classRayBenConvection_a1feee928e15de6738a5c468fc10ab263}{m\_pp}} = m\_my\_symamd(\mbox{\hyperlink{classRayBenConvection_a279afbe74b425c0a05bdcc3f854ebe79}{m\_A}});}
\DoxyCodeLine{760 }
\DoxyCodeLine{761   \mbox{\hyperlink{classRayBenConvection_a529194ad06a9e9a2f13259c7620aeade}{m\_Aperm}} = \mbox{\hyperlink{classRayBenConvection_a279afbe74b425c0a05bdcc3f854ebe79}{m\_A}}(\mbox{\hyperlink{classRayBenConvection_a1feee928e15de6738a5c468fc10ab263}{m\_pp}},\mbox{\hyperlink{classRayBenConvection_a1feee928e15de6738a5c468fc10ab263}{m\_pp}});}
\DoxyCodeLine{762 }
\DoxyCodeLine{763   m\_luP(\mbox{\hyperlink{classRayBenConvection_a529194ad06a9e9a2f13259c7620aeade}{m\_Aperm}}, \mbox{\hyperlink{classRayBenConvection_ac749448feff68e1d70ba6df4c6b6308d}{m\_LUp}});}
\DoxyCodeLine{764 }
\DoxyCodeLine{765   \textcolor{comment}{//\%\%}}
\DoxyCodeLine{766   \textcolor{comment}{//\%B.C vector(for T)}}
\DoxyCodeLine{767   \mbox{\hyperlink{classRayBenConvection_a0bce1c4229b75dd03d882abcc7612e8c}{m\_bcT}}.setZero();}
\DoxyCodeLine{768   \mbox{\hyperlink{classRayBenConvection_a0bce1c4229b75dd03d882abcc7612e8c}{m\_bcT}}.row(0).setConstant(-\/ \mbox{\hyperlink{classRayBenConvection_a643232d08102a38ddd0ec9a618b55afd}{m\_TnW}} / \mbox{\hyperlink{classRayBenConvection_a2bb417e336a4ae74e517e2eba04d179d}{m\_dx}}); }
\DoxyCodeLine{769   \mbox{\hyperlink{classRayBenConvection_a0bce1c4229b75dd03d882abcc7612e8c}{m\_bcT}}.row(\mbox{\hyperlink{classRayBenConvection_a0bce1c4229b75dd03d882abcc7612e8c}{m\_bcT}}.rows()-\/1).setConstant(\mbox{\hyperlink{classRayBenConvection_aeb469e88e053251916cbcf2e0dd1919a}{m\_TnE}} / \mbox{\hyperlink{classRayBenConvection_a2bb417e336a4ae74e517e2eba04d179d}{m\_dx}});}
\DoxyCodeLine{770   \mbox{\hyperlink{classRayBenConvection_a0bce1c4229b75dd03d882abcc7612e8c}{m\_bcT}}.col(0).setConstant(\mbox{\hyperlink{classRayBenConvection_ac1331aa9a8a5f7b079af0df68bc3dcfc}{m\_TS}} / std::pow(\mbox{\hyperlink{classRayBenConvection_a6d70b64b68c44a8b5f4ed5ca86dfcf71}{m\_dy}},2)); }
\DoxyCodeLine{771   \mbox{\hyperlink{classRayBenConvection_a0bce1c4229b75dd03d882abcc7612e8c}{m\_bcT}}.col(\mbox{\hyperlink{classRayBenConvection_a0bce1c4229b75dd03d882abcc7612e8c}{m\_bcT}}.cols()-\/1).setConstant(\mbox{\hyperlink{classRayBenConvection_a0fade52114cb600deba397e9c3d86b12}{m\_TN}} / std::pow(\mbox{\hyperlink{classRayBenConvection_a6d70b64b68c44a8b5f4ed5ca86dfcf71}{m\_dy}},2));}
\DoxyCodeLine{772 }
\DoxyCodeLine{773   \textcolor{comment}{//\%B.Cs at the corners:}}
\DoxyCodeLine{774   \mbox{\hyperlink{classRayBenConvection_a0bce1c4229b75dd03d882abcc7612e8c}{m\_bcT}}(0, 0)                       = -\/ \mbox{\hyperlink{classRayBenConvection_a643232d08102a38ddd0ec9a618b55afd}{m\_TnW}} / \mbox{\hyperlink{classRayBenConvection_a2bb417e336a4ae74e517e2eba04d179d}{m\_dx}} + \mbox{\hyperlink{classRayBenConvection_ac1331aa9a8a5f7b079af0df68bc3dcfc}{m\_TS}} / std::pow(\mbox{\hyperlink{classRayBenConvection_a6d70b64b68c44a8b5f4ed5ca86dfcf71}{m\_dy}},2);}
\DoxyCodeLine{775   \mbox{\hyperlink{classRayBenConvection_a0bce1c4229b75dd03d882abcc7612e8c}{m\_bcT}}(\mbox{\hyperlink{classRayBenConvection_a0bce1c4229b75dd03d882abcc7612e8c}{m\_bcT}}.rows()-\/1, 0)            = \mbox{\hyperlink{classRayBenConvection_aeb469e88e053251916cbcf2e0dd1919a}{m\_TnE}} / \mbox{\hyperlink{classRayBenConvection_a2bb417e336a4ae74e517e2eba04d179d}{m\_dx}} + \mbox{\hyperlink{classRayBenConvection_ac1331aa9a8a5f7b079af0df68bc3dcfc}{m\_TS}} / std::pow(\mbox{\hyperlink{classRayBenConvection_a6d70b64b68c44a8b5f4ed5ca86dfcf71}{m\_dy}},2);}
\DoxyCodeLine{776   \mbox{\hyperlink{classRayBenConvection_a0bce1c4229b75dd03d882abcc7612e8c}{m\_bcT}}(0, \mbox{\hyperlink{classRayBenConvection_a0bce1c4229b75dd03d882abcc7612e8c}{m\_bcT}}.cols()-\/1)            = -\/ \mbox{\hyperlink{classRayBenConvection_a643232d08102a38ddd0ec9a618b55afd}{m\_TnW}} / \mbox{\hyperlink{classRayBenConvection_a2bb417e336a4ae74e517e2eba04d179d}{m\_dx}} + \mbox{\hyperlink{classRayBenConvection_a0fade52114cb600deba397e9c3d86b12}{m\_TN}} / std::pow(\mbox{\hyperlink{classRayBenConvection_a6d70b64b68c44a8b5f4ed5ca86dfcf71}{m\_dy}},2);}
\DoxyCodeLine{777   \mbox{\hyperlink{classRayBenConvection_a0bce1c4229b75dd03d882abcc7612e8c}{m\_bcT}}(\mbox{\hyperlink{classRayBenConvection_a0bce1c4229b75dd03d882abcc7612e8c}{m\_bcT}}.rows()-\/1, \mbox{\hyperlink{classRayBenConvection_a0bce1c4229b75dd03d882abcc7612e8c}{m\_bcT}}.cols()-\/1) = \mbox{\hyperlink{classRayBenConvection_aeb469e88e053251916cbcf2e0dd1919a}{m\_TnE}} / \mbox{\hyperlink{classRayBenConvection_a2bb417e336a4ae74e517e2eba04d179d}{m\_dx}} + \mbox{\hyperlink{classRayBenConvection_a0fade52114cb600deba397e9c3d86b12}{m\_TN}} / std::pow(\mbox{\hyperlink{classRayBenConvection_a6d70b64b68c44a8b5f4ed5ca86dfcf71}{m\_dy}},2);}
\DoxyCodeLine{778   \mbox{\hyperlink{classRayBenConvection_a0bce1c4229b75dd03d882abcc7612e8c}{m\_bcT}} = \mbox{\hyperlink{classRayBenConvection_ae106f4c67cc111c54d23730e8e7fa7e6}{m\_dt}} * \mbox{\hyperlink{classRayBenConvection_a0bce1c4229b75dd03d882abcc7612e8c}{m\_bcT}} / m\_Pe;}
\DoxyCodeLine{779 }
\DoxyCodeLine{780   \textcolor{comment}{//Central difference operator(for T)}}
\DoxyCodeLine{781   \mbox{\hyperlink{classRayBenConvection_abbc6bb7a871ccde05c4b5a9519eb7cd8}{m\_e}}.resize(\mbox{\hyperlink{classRayBenConvection_a00ece8699bc4531e4dc5edfe2cfcfd7b}{m\_nx}}-\/2, 1);}
\DoxyCodeLine{782   \mbox{\hyperlink{classRayBenConvection_abbc6bb7a871ccde05c4b5a9519eb7cd8}{m\_e}}.setOnes();}
\DoxyCodeLine{783   \mbox{\hyperlink{classRayBenConvection_ada01bc16d6b738fef671eb8c21461d40}{m\_i}}.resize(\mbox{\hyperlink{classRayBenConvection_aa2e29e985716895f8f19e3930078ec00}{m\_ny}}-\/2, 1);}
\DoxyCodeLine{784   \mbox{\hyperlink{classRayBenConvection_ada01bc16d6b738fef671eb8c21461d40}{m\_i}}.setOnes();}
\DoxyCodeLine{785 }
\DoxyCodeLine{786   \mbox{\hyperlink{classRayBenConvection_aecd4a1a57801dd8f6b8287b3903de288}{m\_Tx}} = m\_spdiags(}
\DoxyCodeLine{787     \textcolor{keyword}{static\_cast<}Eigen::Matrix<\textcolor{keywordtype}{double}, -\/1, -\/1\textcolor{keyword}{>}>(\mbox{\hyperlink{classRayBenConvection_abbc6bb7a871ccde05c4b5a9519eb7cd8}{m\_e}} * Eigen::Matrix<double, 1, 3>(1, -\/2, 1)),}
\DoxyCodeLine{788     Eigen::Matrix<int, 1, 3> (-\/1, 0, 1),}
\DoxyCodeLine{789     \mbox{\hyperlink{classRayBenConvection_a00ece8699bc4531e4dc5edfe2cfcfd7b}{m\_nx}}-\/2, \mbox{\hyperlink{classRayBenConvection_a00ece8699bc4531e4dc5edfe2cfcfd7b}{m\_nx}}-\/2}
\DoxyCodeLine{790     );}
\DoxyCodeLine{791 }
\DoxyCodeLine{792   \mbox{\hyperlink{classRayBenConvection_accf0b01090460e7a90bbae1e983b27b9}{m\_Ty}} = m\_spdiags(}
\DoxyCodeLine{793     \textcolor{keyword}{static\_cast<}Eigen::Matrix<\textcolor{keywordtype}{double}, -\/1, -\/1\textcolor{keyword}{>}>(\mbox{\hyperlink{classRayBenConvection_ada01bc16d6b738fef671eb8c21461d40}{m\_i}} * Eigen::Matrix<double, 1, 3>(1, -\/2, 1)),}
\DoxyCodeLine{794     Eigen::Matrix<int, 1, 3> (-\/1, 0, 1),}
\DoxyCodeLine{795     \mbox{\hyperlink{classRayBenConvection_aa2e29e985716895f8f19e3930078ec00}{m\_ny}}-\/2, \mbox{\hyperlink{classRayBenConvection_aa2e29e985716895f8f19e3930078ec00}{m\_ny}}-\/2}
\DoxyCodeLine{796     );}
\DoxyCodeLine{797 }
\DoxyCodeLine{798   \mbox{\hyperlink{classRayBenConvection_aecd4a1a57801dd8f6b8287b3903de288}{m\_Tx}}(0, 0) = -\/1;}
\DoxyCodeLine{799   \mbox{\hyperlink{classRayBenConvection_aecd4a1a57801dd8f6b8287b3903de288}{m\_Tx}}(\mbox{\hyperlink{classRayBenConvection_aecd4a1a57801dd8f6b8287b3903de288}{m\_Tx}}.rows()-\/1, \mbox{\hyperlink{classRayBenConvection_aecd4a1a57801dd8f6b8287b3903de288}{m\_Tx}}.cols()-\/1) = -\/1; }
\DoxyCodeLine{800 }
\DoxyCodeLine{801   \mbox{\hyperlink{classRayBenConvection_af531dfbb0312d1411695bc513f9fc3ab}{m\_Tt}} = m\_kron<double>(}
\DoxyCodeLine{802         \textcolor{keyword}{static\_cast<}Eigen::Matrix<\textcolor{keywordtype}{double}, -\/1, -\/1\textcolor{keyword}{>}>(\mbox{\hyperlink{classRayBenConvection_accf0b01090460e7a90bbae1e983b27b9}{m\_Ty}}/std::pow(\mbox{\hyperlink{classRayBenConvection_a6d70b64b68c44a8b5f4ed5ca86dfcf71}{m\_dy}},2)),}
\DoxyCodeLine{803   Eigen::Matrix<double, m\_nx-\/2, m\_nx-\/2>::Identity()}
\DoxyCodeLine{804       )}
\DoxyCodeLine{805       + m\_kron<double>(}
\DoxyCodeLine{806         Eigen::Matrix<double, m\_ny-\/2, m\_ny-\/2>::Identity(),}
\DoxyCodeLine{807         \textcolor{keyword}{static\_cast<}Eigen::Matrix<\textcolor{keywordtype}{double}, -\/1, -\/1\textcolor{keyword}{>}>(\mbox{\hyperlink{classRayBenConvection_aecd4a1a57801dd8f6b8287b3903de288}{m\_Tx}}/std::pow(\mbox{\hyperlink{classRayBenConvection_a2bb417e336a4ae74e517e2eba04d179d}{m\_dx}},2))}
\DoxyCodeLine{808       );}
\DoxyCodeLine{809 }
\DoxyCodeLine{810   \mbox{\hyperlink{classRayBenConvection_af531dfbb0312d1411695bc513f9fc3ab}{m\_Tt}} = Eigen::Matrix<double, (\mbox{\hyperlink{classRayBenConvection_a00ece8699bc4531e4dc5edfe2cfcfd7b}{m\_nx}}-\/2)*(\mbox{\hyperlink{classRayBenConvection_aa2e29e985716895f8f19e3930078ec00}{m\_ny}}-\/2), (\mbox{\hyperlink{classRayBenConvection_a00ece8699bc4531e4dc5edfe2cfcfd7b}{m\_nx}}-\/2)*(\mbox{\hyperlink{classRayBenConvection_aa2e29e985716895f8f19e3930078ec00}{m\_ny}}-\/2)>::Identity() -\/ \mbox{\hyperlink{classRayBenConvection_ae106f4c67cc111c54d23730e8e7fa7e6}{m\_dt}} * \mbox{\hyperlink{classRayBenConvection_af531dfbb0312d1411695bc513f9fc3ab}{m\_Tt}}/m\_Pe;}
\DoxyCodeLine{811 }
\DoxyCodeLine{812   \mbox{\hyperlink{classRayBenConvection_a29a766e0a44d52126e84113fab8bc790}{m\_pt}} = m\_my\_symamd(\mbox{\hyperlink{classRayBenConvection_af531dfbb0312d1411695bc513f9fc3ab}{m\_Tt}});}
\DoxyCodeLine{813 }
\DoxyCodeLine{814   \mbox{\hyperlink{classRayBenConvection_a20f9d47123df134ba81616d5c9ce7829}{m\_Ttperm}} = \mbox{\hyperlink{classRayBenConvection_af531dfbb0312d1411695bc513f9fc3ab}{m\_Tt}}(\mbox{\hyperlink{classRayBenConvection_a29a766e0a44d52126e84113fab8bc790}{m\_pt}},\mbox{\hyperlink{classRayBenConvection_a29a766e0a44d52126e84113fab8bc790}{m\_pt}});}
\DoxyCodeLine{815 }
\DoxyCodeLine{816   m\_luP(\mbox{\hyperlink{classRayBenConvection_a20f9d47123df134ba81616d5c9ce7829}{m\_Ttperm}}, \mbox{\hyperlink{classRayBenConvection_a9fe814ef49f949598da4f414870da1d3}{m\_LUt}});}
\DoxyCodeLine{817 }
\DoxyCodeLine{818   \textcolor{comment}{//\%\%}}
\DoxyCodeLine{819   \textcolor{comment}{//\%Boundary conditions}}
\DoxyCodeLine{820   \mbox{\hyperlink{classRayBenConvection_aecfd1a81f7bc8e559a3d17237ebf227c}{m\_T}}.row(0) = \mbox{\hyperlink{classRayBenConvection_aecfd1a81f7bc8e559a3d17237ebf227c}{m\_T}}.row(1) -\/ Eigen::Matrix<double, 1, m\_ny>::Constant(\mbox{\hyperlink{classRayBenConvection_a643232d08102a38ddd0ec9a618b55afd}{m\_TnW}} * \mbox{\hyperlink{classRayBenConvection_a2bb417e336a4ae74e517e2eba04d179d}{m\_dx}});}
\DoxyCodeLine{821   \mbox{\hyperlink{classRayBenConvection_aecfd1a81f7bc8e559a3d17237ebf227c}{m\_T}}.row(\mbox{\hyperlink{classRayBenConvection_aecfd1a81f7bc8e559a3d17237ebf227c}{m\_T}}.rows()-\/1) = \mbox{\hyperlink{classRayBenConvection_aecfd1a81f7bc8e559a3d17237ebf227c}{m\_T}}.row(\mbox{\hyperlink{classRayBenConvection_aecfd1a81f7bc8e559a3d17237ebf227c}{m\_T}}.rows()-\/2) + Eigen::Matrix<double, 1, m\_ny>::Constant(\mbox{\hyperlink{classRayBenConvection_aeb469e88e053251916cbcf2e0dd1919a}{m\_TnE}} * \mbox{\hyperlink{classRayBenConvection_a2bb417e336a4ae74e517e2eba04d179d}{m\_dx}});}
\DoxyCodeLine{822   \mbox{\hyperlink{classRayBenConvection_aecfd1a81f7bc8e559a3d17237ebf227c}{m\_T}}.col(0).setConstant(\mbox{\hyperlink{classRayBenConvection_ac1331aa9a8a5f7b079af0df68bc3dcfc}{m\_TS}});}
\DoxyCodeLine{823   \mbox{\hyperlink{classRayBenConvection_aecfd1a81f7bc8e559a3d17237ebf227c}{m\_T}}.col(\mbox{\hyperlink{classRayBenConvection_aecfd1a81f7bc8e559a3d17237ebf227c}{m\_T}}.cols()-\/1).setConstant(\mbox{\hyperlink{classRayBenConvection_a0fade52114cb600deba397e9c3d86b12}{m\_TN}});}
\DoxyCodeLine{824 }
\DoxyCodeLine{825   \mbox{\hyperlink{classRayBenConvection_ac9933db8381584f9d732b85391da2533}{m\_u}}.row(0) = Eigen::Matrix<double, 1, m\_ny>::Constant(2 * \mbox{\hyperlink{classRayBenConvection_a56534034d797d9099f53367d4828f0c7}{m\_UW}}) -\/ \mbox{\hyperlink{classRayBenConvection_ac9933db8381584f9d732b85391da2533}{m\_u}}.row(1);}
\DoxyCodeLine{826   \mbox{\hyperlink{classRayBenConvection_ac9933db8381584f9d732b85391da2533}{m\_u}}.row(\mbox{\hyperlink{classRayBenConvection_ac9933db8381584f9d732b85391da2533}{m\_u}}.rows()-\/1) = Eigen::Matrix<double, 1, m\_ny>::Constant(2 * \mbox{\hyperlink{classRayBenConvection_ad3b4ec6a6500a9b9355c60d66a62091b}{m\_UE}}) -\/ \mbox{\hyperlink{classRayBenConvection_ac9933db8381584f9d732b85391da2533}{m\_u}}.row(\mbox{\hyperlink{classRayBenConvection_ac9933db8381584f9d732b85391da2533}{m\_u}}.rows()-\/2);}
\DoxyCodeLine{827   \mbox{\hyperlink{classRayBenConvection_ac9933db8381584f9d732b85391da2533}{m\_u}}.col(0).setConstant(\mbox{\hyperlink{classRayBenConvection_a99f0d9ab29a2db33829175a790fa9bc7}{m\_US}});}
\DoxyCodeLine{828   \mbox{\hyperlink{classRayBenConvection_ac9933db8381584f9d732b85391da2533}{m\_u}}.col(\mbox{\hyperlink{classRayBenConvection_ac9933db8381584f9d732b85391da2533}{m\_u}}.cols()-\/1).setConstant(\mbox{\hyperlink{classRayBenConvection_aab15fee9f0b6d470dd9d02d85439a7a8}{m\_UN}});}
\DoxyCodeLine{829 }
\DoxyCodeLine{830   \mbox{\hyperlink{classRayBenConvection_af863193c10cffeaf20f749df0ec845a5}{m\_v}}.row(0).setConstant(\mbox{\hyperlink{classRayBenConvection_aee29299c3f2cf435a3d179d4dcd9b0a1}{m\_VW}});}
\DoxyCodeLine{831   \mbox{\hyperlink{classRayBenConvection_af863193c10cffeaf20f749df0ec845a5}{m\_v}}.row(\mbox{\hyperlink{classRayBenConvection_af863193c10cffeaf20f749df0ec845a5}{m\_v}}.rows()-\/1).setConstant(\mbox{\hyperlink{classRayBenConvection_abfccbde057005c07f8ee2b76ef68e4f7}{m\_VE}});}
\DoxyCodeLine{832   \mbox{\hyperlink{classRayBenConvection_af863193c10cffeaf20f749df0ec845a5}{m\_v}}.col(0) = Eigen::Matrix<double, m\_nx, 1>::Constant(2 * \mbox{\hyperlink{classRayBenConvection_afc0d1ada59367f173257a20e2cea845b}{m\_VS}}) -\/ \mbox{\hyperlink{classRayBenConvection_af863193c10cffeaf20f749df0ec845a5}{m\_v}}.col(1);}
\DoxyCodeLine{833   \mbox{\hyperlink{classRayBenConvection_af863193c10cffeaf20f749df0ec845a5}{m\_v}}.col(\mbox{\hyperlink{classRayBenConvection_af863193c10cffeaf20f749df0ec845a5}{m\_v}}.cols()-\/1) = Eigen::Matrix<double, m\_nx, 1>::Constant(2 * \mbox{\hyperlink{classRayBenConvection_ace7b32dda44cace25edfe8e481601733}{m\_VN}}) -\/ \mbox{\hyperlink{classRayBenConvection_af863193c10cffeaf20f749df0ec845a5}{m\_v}}.col(\mbox{\hyperlink{classRayBenConvection_af863193c10cffeaf20f749df0ec845a5}{m\_v}}.cols()-\/2);}
\DoxyCodeLine{834 }
\DoxyCodeLine{835   \textcolor{comment}{//FIXME: questo commento annuncia l'inizio del for?  }}
\DoxyCodeLine{836   \textcolor{comment}{//\%\%}}
\DoxyCodeLine{837   \textcolor{comment}{//\%Evaluating temperature and velocity field at each time step}}
\DoxyCodeLine{838 }
\DoxyCodeLine{839   \textcolor{comment}{//Easying solver calculations: eleoicca stuff}}
\DoxyCodeLine{840   \mbox{\hyperlink{classRayBenConvection_aaf54f2309f7ac98e9f2cc449eae6bd37}{m\_Lu\_solver}}.compute(\mbox{\hyperlink{classRayBenConvection_a2c0c7f84f7a1a702878f9980a4772bc0}{m\_LUu}}[0]);}
\DoxyCodeLine{841 }
\DoxyCodeLine{842   \mbox{\hyperlink{classRayBenConvection_abc851be2138ae32b40834060bffe5a69}{m\_Uu\_solver}}.compute(\mbox{\hyperlink{classRayBenConvection_a2c0c7f84f7a1a702878f9980a4772bc0}{m\_LUu}}[1]);}
\DoxyCodeLine{843 }
\DoxyCodeLine{844   \mbox{\hyperlink{classRayBenConvection_ab7a3c25d7d180499643a96b52c376ef8}{m\_Lv\_solver}}.compute(m\_LUv[0]);}
\DoxyCodeLine{845 }
\DoxyCodeLine{846   \mbox{\hyperlink{classRayBenConvection_a41024c3b9faa8588e3ecd679203b2e4c}{m\_Uv\_solver}}.compute(m\_LUv[1]);}
\DoxyCodeLine{847 }
\DoxyCodeLine{848   \mbox{\hyperlink{classRayBenConvection_a6287ec3344a639bccc0ae10bb04aa900}{m\_Lp\_solver}}.compute(\mbox{\hyperlink{classRayBenConvection_ac749448feff68e1d70ba6df4c6b6308d}{m\_LUp}}[0]);}
\DoxyCodeLine{849 }
\DoxyCodeLine{850   \mbox{\hyperlink{classRayBenConvection_ad38e2b16fa2e62e025fdcf2951266761}{m\_Up\_solver}}.compute(\mbox{\hyperlink{classRayBenConvection_ac749448feff68e1d70ba6df4c6b6308d}{m\_LUp}}[1]);}
\DoxyCodeLine{851 }
\DoxyCodeLine{852   \mbox{\hyperlink{classRayBenConvection_a8d69aac2c20b371f05105b46b893f76c}{m\_Lt\_solver}}.compute(\mbox{\hyperlink{classRayBenConvection_a9fe814ef49f949598da4f414870da1d3}{m\_LUt}}[0]);}
\DoxyCodeLine{853 }
\DoxyCodeLine{854   \mbox{\hyperlink{classRayBenConvection_a02288b2063d3f4a257791f0fe5933b81}{m\_Ut\_solver}}.compute(\mbox{\hyperlink{classRayBenConvection_a9fe814ef49f949598da4f414870da1d3}{m\_LUt}}[1]);}
\DoxyCodeLine{855 }
\DoxyCodeLine{856   std::cerr << \textcolor{stringliteral}{"{}INFO: RayBenConvection: init: Done! Time spent during initialization function: "{}}}
\DoxyCodeLine{857   << \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{float}\textcolor{keyword}{>}(}
\DoxyCodeLine{858        std::chrono::duration\_cast<std::chrono::milliseconds>(}
\DoxyCodeLine{859           std::chrono::high\_resolution\_clock::now() -\/ init\_lenght}
\DoxyCodeLine{860        ).count()}
\DoxyCodeLine{861      ) / 1000}
\DoxyCodeLine{862   << \textcolor{stringliteral}{"{}s"{}} << std::endl;}
\DoxyCodeLine{863 }
\DoxyCodeLine{864   \mbox{\hyperlink{classRayBenConvection_af8611d2ad5bd585ec902c30895c8a916}{m\_it}}=0;}
\DoxyCodeLine{865 }
\DoxyCodeLine{866 }
\DoxyCodeLine{867   \textcolor{keywordflow}{return} ret\_value;}
\DoxyCodeLine{868 }
\DoxyCodeLine{869 \}}
\DoxyCodeLine{870 }
\DoxyCodeLine{871 \mbox{\hyperlink{structRayBenConvection_1_1simulation__state__t}{RayBenConvection::simulation\_state\_t}} RayBenConvection::eval\_next\_frame()\{}
\DoxyCodeLine{872 }
\DoxyCodeLine{873   \textcolor{comment}{//const unsigned int m\_ii = m\_nx-\/2;}}
\DoxyCodeLine{874   \textcolor{comment}{//const unsigned int m\_jj = m\_ny-\/2;}}
\DoxyCodeLine{875 }
\DoxyCodeLine{876   \textcolor{keywordflow}{if} (\mbox{\hyperlink{classRayBenConvection_af8611d2ad5bd585ec902c30895c8a916}{m\_it}} < \mbox{\hyperlink{classRayBenConvection_a30361d2ad21ab61d60fb8bb21fba82de}{m\_END\_CICLE}} ) \{}
\DoxyCodeLine{877 }
\DoxyCodeLine{878     m\_ETA(\mbox{\hyperlink{classRayBenConvection_af8611d2ad5bd585ec902c30895c8a916}{m\_it}});}
\DoxyCodeLine{879 }
\DoxyCodeLine{880     \mbox{\hyperlink{classRayBenConvection_a834f45458ac6473a81c3457603809cd3}{m\_apply\_correction}}();}
\DoxyCodeLine{881 }
\DoxyCodeLine{882 }
\DoxyCodeLine{883     Eigen::Matrix<double, -\/1, -\/1> Tn(\mbox{\hyperlink{classRayBenConvection_aecfd1a81f7bc8e559a3d17237ebf227c}{m\_T}});}
\DoxyCodeLine{884     \mbox{\hyperlink{classRayBenConvection_a0369de1dcfd6a9c4681a22ef77281bad}{m\_Tstar}}.block(1,1,\mbox{\hyperlink{classRayBenConvection_ad5d8335e885b5f4d0860b379d785eb24}{m\_ii}},\mbox{\hyperlink{classRayBenConvection_a3f18799795eb3b79188f14aeed0c427b}{m\_jj}}) = (Tn.block(1,1,\mbox{\hyperlink{classRayBenConvection_ad5d8335e885b5f4d0860b379d785eb24}{m\_ii}},\mbox{\hyperlink{classRayBenConvection_a3f18799795eb3b79188f14aeed0c427b}{m\_jj}}).array() -\/ (\mbox{\hyperlink{classRayBenConvection_ae106f4c67cc111c54d23730e8e7fa7e6}{m\_dt}} / \mbox{\hyperlink{classRayBenConvection_a2bb417e336a4ae74e517e2eba04d179d}{m\_dx}} / 2)}
\DoxyCodeLine{885       * (\mbox{\hyperlink{classRayBenConvection_ac9933db8381584f9d732b85391da2533}{m\_u}}.block(2,1,\mbox{\hyperlink{classRayBenConvection_ad5d8335e885b5f4d0860b379d785eb24}{m\_ii}},\mbox{\hyperlink{classRayBenConvection_a3f18799795eb3b79188f14aeed0c427b}{m\_jj}}).array() * (Tn.block(1,1,\mbox{\hyperlink{classRayBenConvection_ad5d8335e885b5f4d0860b379d785eb24}{m\_ii}},\mbox{\hyperlink{classRayBenConvection_a3f18799795eb3b79188f14aeed0c427b}{m\_jj}}) + Tn.block(2,1,\mbox{\hyperlink{classRayBenConvection_ad5d8335e885b5f4d0860b379d785eb24}{m\_ii}},\mbox{\hyperlink{classRayBenConvection_a3f18799795eb3b79188f14aeed0c427b}{m\_jj}})).array() }
\DoxyCodeLine{886       -\/ \mbox{\hyperlink{classRayBenConvection_ac9933db8381584f9d732b85391da2533}{m\_u}}.block(1,1,\mbox{\hyperlink{classRayBenConvection_ad5d8335e885b5f4d0860b379d785eb24}{m\_ii}},\mbox{\hyperlink{classRayBenConvection_a3f18799795eb3b79188f14aeed0c427b}{m\_jj}}).array() * (Tn.block(1,1,\mbox{\hyperlink{classRayBenConvection_ad5d8335e885b5f4d0860b379d785eb24}{m\_ii}},\mbox{\hyperlink{classRayBenConvection_a3f18799795eb3b79188f14aeed0c427b}{m\_jj}}) + Tn.block(0,1,\mbox{\hyperlink{classRayBenConvection_ad5d8335e885b5f4d0860b379d785eb24}{m\_ii}},\mbox{\hyperlink{classRayBenConvection_a3f18799795eb3b79188f14aeed0c427b}{m\_jj}})).array()) }
\DoxyCodeLine{887       -\/ (\mbox{\hyperlink{classRayBenConvection_ae106f4c67cc111c54d23730e8e7fa7e6}{m\_dt}} / \mbox{\hyperlink{classRayBenConvection_a6d70b64b68c44a8b5f4ed5ca86dfcf71}{m\_dy}} / 2)}
\DoxyCodeLine{888       * (\mbox{\hyperlink{classRayBenConvection_af863193c10cffeaf20f749df0ec845a5}{m\_v}}.block(1,2,\mbox{\hyperlink{classRayBenConvection_ad5d8335e885b5f4d0860b379d785eb24}{m\_ii}},\mbox{\hyperlink{classRayBenConvection_a3f18799795eb3b79188f14aeed0c427b}{m\_jj}}).array() * (Tn.block(1,1,\mbox{\hyperlink{classRayBenConvection_ad5d8335e885b5f4d0860b379d785eb24}{m\_ii}},\mbox{\hyperlink{classRayBenConvection_a3f18799795eb3b79188f14aeed0c427b}{m\_jj}}) + Tn.block(1,2,\mbox{\hyperlink{classRayBenConvection_ad5d8335e885b5f4d0860b379d785eb24}{m\_ii}},\mbox{\hyperlink{classRayBenConvection_a3f18799795eb3b79188f14aeed0c427b}{m\_jj}})).array()}
\DoxyCodeLine{889       -\/ \mbox{\hyperlink{classRayBenConvection_af863193c10cffeaf20f749df0ec845a5}{m\_v}}.block(1,1,\mbox{\hyperlink{classRayBenConvection_ad5d8335e885b5f4d0860b379d785eb24}{m\_ii}},\mbox{\hyperlink{classRayBenConvection_a3f18799795eb3b79188f14aeed0c427b}{m\_jj}}).array() * (Tn.block(1,1,\mbox{\hyperlink{classRayBenConvection_ad5d8335e885b5f4d0860b379d785eb24}{m\_ii}},\mbox{\hyperlink{classRayBenConvection_a3f18799795eb3b79188f14aeed0c427b}{m\_jj}}) + Tn.block(1,0,\mbox{\hyperlink{classRayBenConvection_ad5d8335e885b5f4d0860b379d785eb24}{m\_ii}},\mbox{\hyperlink{classRayBenConvection_a3f18799795eb3b79188f14aeed0c427b}{m\_jj}})).array())).matrix();}
\DoxyCodeLine{890 }
\DoxyCodeLine{891     Eigen::Matrix<double, -\/1, 1> t;}
\DoxyCodeLine{892     t.resize(\mbox{\hyperlink{classRayBenConvection_a0bce1c4229b75dd03d882abcc7612e8c}{m\_bcT}}.rows()*\mbox{\hyperlink{classRayBenConvection_a0bce1c4229b75dd03d882abcc7612e8c}{m\_bcT}}.cols(), 1);}
\DoxyCodeLine{893     t.col(0) = (\mbox{\hyperlink{classRayBenConvection_a0369de1dcfd6a9c4681a22ef77281bad}{m\_Tstar}}.block(1,1,\mbox{\hyperlink{classRayBenConvection_a0369de1dcfd6a9c4681a22ef77281bad}{m\_Tstar}}.rows()-\/2,\mbox{\hyperlink{classRayBenConvection_a0369de1dcfd6a9c4681a22ef77281bad}{m\_Tstar}}.cols()-\/2) + \mbox{\hyperlink{classRayBenConvection_a0bce1c4229b75dd03d882abcc7612e8c}{m\_bcT}}).reshaped(\mbox{\hyperlink{classRayBenConvection_a0bce1c4229b75dd03d882abcc7612e8c}{m\_bcT}}.rows()*\mbox{\hyperlink{classRayBenConvection_a0bce1c4229b75dd03d882abcc7612e8c}{m\_bcT}}.cols(), 1);}
\DoxyCodeLine{894 }
\DoxyCodeLine{895     t(\mbox{\hyperlink{classRayBenConvection_a29a766e0a44d52126e84113fab8bc790}{m\_pt}}) = \textcolor{keyword}{static\_cast<}Eigen::Matrix<\textcolor{keywordtype}{double}, -\/1, -\/1\textcolor{keyword}{>}>(\mbox{\hyperlink{classRayBenConvection_a02288b2063d3f4a257791f0fe5933b81}{m\_Ut\_solver}}.solve(\mbox{\hyperlink{classRayBenConvection_a8d69aac2c20b371f05105b46b893f76c}{m\_Lt\_solver}}.solve(t(\mbox{\hyperlink{classRayBenConvection_a29a766e0a44d52126e84113fab8bc790}{m\_pt}}))));}
\DoxyCodeLine{896 }
\DoxyCodeLine{897     Eigen::Matrix<double, -\/1, -\/1> new\_t = t.reshaped(\mbox{\hyperlink{classRayBenConvection_a00ece8699bc4531e4dc5edfe2cfcfd7b}{m\_nx}}-\/2, \mbox{\hyperlink{classRayBenConvection_aa2e29e985716895f8f19e3930078ec00}{m\_ny}}-\/2);}
\DoxyCodeLine{898 }
\DoxyCodeLine{899     \mbox{\hyperlink{classRayBenConvection_aecfd1a81f7bc8e559a3d17237ebf227c}{m\_T}}.block(1,1,\mbox{\hyperlink{classRayBenConvection_aecfd1a81f7bc8e559a3d17237ebf227c}{m\_T}}.rows()-\/2,\mbox{\hyperlink{classRayBenConvection_aecfd1a81f7bc8e559a3d17237ebf227c}{m\_T}}.cols()-\/2) = new\_t;}
\DoxyCodeLine{900 }
\DoxyCodeLine{901     \mbox{\hyperlink{classRayBenConvection_aecfd1a81f7bc8e559a3d17237ebf227c}{m\_T}}.row(0) = \mbox{\hyperlink{classRayBenConvection_aecfd1a81f7bc8e559a3d17237ebf227c}{m\_T}}.row(1) -\/ Eigen::Matrix<double, 1, m\_ny>::Constant(\mbox{\hyperlink{classRayBenConvection_a643232d08102a38ddd0ec9a618b55afd}{m\_TnW}} * \mbox{\hyperlink{classRayBenConvection_a2bb417e336a4ae74e517e2eba04d179d}{m\_dx}});}
\DoxyCodeLine{902     \mbox{\hyperlink{classRayBenConvection_aecfd1a81f7bc8e559a3d17237ebf227c}{m\_T}}.row(\mbox{\hyperlink{classRayBenConvection_aecfd1a81f7bc8e559a3d17237ebf227c}{m\_T}}.rows()-\/1) = \mbox{\hyperlink{classRayBenConvection_aecfd1a81f7bc8e559a3d17237ebf227c}{m\_T}}.row(\mbox{\hyperlink{classRayBenConvection_aecfd1a81f7bc8e559a3d17237ebf227c}{m\_T}}.rows()-\/2) + Eigen::Matrix<double, 1, m\_ny>::Constant(\mbox{\hyperlink{classRayBenConvection_aeb469e88e053251916cbcf2e0dd1919a}{m\_TnE}} * \mbox{\hyperlink{classRayBenConvection_a2bb417e336a4ae74e517e2eba04d179d}{m\_dx}});}
\DoxyCodeLine{903 }
\DoxyCodeLine{904     \mbox{\hyperlink{classRayBenConvection_aecfd1a81f7bc8e559a3d17237ebf227c}{m\_T}}.col(0).setConstant(\mbox{\hyperlink{classRayBenConvection_ac1331aa9a8a5f7b079af0df68bc3dcfc}{m\_TS}});}
\DoxyCodeLine{905     \mbox{\hyperlink{classRayBenConvection_aecfd1a81f7bc8e559a3d17237ebf227c}{m\_T}}.col(\mbox{\hyperlink{classRayBenConvection_aecfd1a81f7bc8e559a3d17237ebf227c}{m\_T}}.cols()-\/1).setConstant(\mbox{\hyperlink{classRayBenConvection_a0fade52114cb600deba397e9c3d86b12}{m\_TN}});}
\DoxyCodeLine{906 }
\DoxyCodeLine{907     Eigen::Matrix<double, -\/1, -\/1> un = \mbox{\hyperlink{classRayBenConvection_ac9933db8381584f9d732b85391da2533}{m\_u}};}
\DoxyCodeLine{908     Eigen::Matrix<double, -\/1, -\/1> vn = \mbox{\hyperlink{classRayBenConvection_af863193c10cffeaf20f749df0ec845a5}{m\_v}};}
\DoxyCodeLine{909 }
\DoxyCodeLine{910     \textcolor{comment}{//\%Predictor step(Lax-\/Friedrich)}}
\DoxyCodeLine{911     \mbox{\hyperlink{classRayBenConvection_ab1204d12009f19080daa8e48072854cd}{m\_uhalf}}.block(2,1,\mbox{\hyperlink{classRayBenConvection_ad5d8335e885b5f4d0860b379d785eb24}{m\_ii}},\mbox{\hyperlink{classRayBenConvection_a3f18799795eb3b79188f14aeed0c427b}{m\_jj}}) = (0.5 * (un.block(3,1,\mbox{\hyperlink{classRayBenConvection_ad5d8335e885b5f4d0860b379d785eb24}{m\_ii}},\mbox{\hyperlink{classRayBenConvection_a3f18799795eb3b79188f14aeed0c427b}{m\_jj}}) + un.block(1,1,\mbox{\hyperlink{classRayBenConvection_ad5d8335e885b5f4d0860b379d785eb24}{m\_ii}},\mbox{\hyperlink{classRayBenConvection_a3f18799795eb3b79188f14aeed0c427b}{m\_jj}})).array() -\/ (\mbox{\hyperlink{classRayBenConvection_ae106f4c67cc111c54d23730e8e7fa7e6}{m\_dt}} / \mbox{\hyperlink{classRayBenConvection_a2bb417e336a4ae74e517e2eba04d179d}{m\_dx}} / 8)}
\DoxyCodeLine{912                     * (un.block(3,1,\mbox{\hyperlink{classRayBenConvection_ad5d8335e885b5f4d0860b379d785eb24}{m\_ii}},\mbox{\hyperlink{classRayBenConvection_a3f18799795eb3b79188f14aeed0c427b}{m\_jj}}) + un.block(2,1,\mbox{\hyperlink{classRayBenConvection_ad5d8335e885b5f4d0860b379d785eb24}{m\_ii}},\mbox{\hyperlink{classRayBenConvection_a3f18799795eb3b79188f14aeed0c427b}{m\_jj}})).array().square() -\/ (un.block(2,1,\mbox{\hyperlink{classRayBenConvection_ad5d8335e885b5f4d0860b379d785eb24}{m\_ii}},\mbox{\hyperlink{classRayBenConvection_a3f18799795eb3b79188f14aeed0c427b}{m\_jj}})}
\DoxyCodeLine{913                     + un.block(1,1,\mbox{\hyperlink{classRayBenConvection_ad5d8335e885b5f4d0860b379d785eb24}{m\_ii}},\mbox{\hyperlink{classRayBenConvection_a3f18799795eb3b79188f14aeed0c427b}{m\_jj}})).array().square() -\/ (\mbox{\hyperlink{classRayBenConvection_ae106f4c67cc111c54d23730e8e7fa7e6}{m\_dt}} / \mbox{\hyperlink{classRayBenConvection_a6d70b64b68c44a8b5f4ed5ca86dfcf71}{m\_dy}} / 8) * ((un.block(2,1,\mbox{\hyperlink{classRayBenConvection_ad5d8335e885b5f4d0860b379d785eb24}{m\_ii}},\mbox{\hyperlink{classRayBenConvection_a3f18799795eb3b79188f14aeed0c427b}{m\_jj}})}
\DoxyCodeLine{914                     + un.block(2,2,\mbox{\hyperlink{classRayBenConvection_ad5d8335e885b5f4d0860b379d785eb24}{m\_ii}},\mbox{\hyperlink{classRayBenConvection_a3f18799795eb3b79188f14aeed0c427b}{m\_jj}})).array() * (vn.block(1,2,\mbox{\hyperlink{classRayBenConvection_ad5d8335e885b5f4d0860b379d785eb24}{m\_ii}},\mbox{\hyperlink{classRayBenConvection_a3f18799795eb3b79188f14aeed0c427b}{m\_jj}}) + vn.block(2,2,\mbox{\hyperlink{classRayBenConvection_ad5d8335e885b5f4d0860b379d785eb24}{m\_ii}},\mbox{\hyperlink{classRayBenConvection_a3f18799795eb3b79188f14aeed0c427b}{m\_jj}})).array()}
\DoxyCodeLine{915                     -\/ (un.block(2,1,\mbox{\hyperlink{classRayBenConvection_ad5d8335e885b5f4d0860b379d785eb24}{m\_ii}},\mbox{\hyperlink{classRayBenConvection_a3f18799795eb3b79188f14aeed0c427b}{m\_jj}}) + un.block(2,0,\mbox{\hyperlink{classRayBenConvection_ad5d8335e885b5f4d0860b379d785eb24}{m\_ii}},\mbox{\hyperlink{classRayBenConvection_a3f18799795eb3b79188f14aeed0c427b}{m\_jj}})).array() * (vn.block(1,1,\mbox{\hyperlink{classRayBenConvection_ad5d8335e885b5f4d0860b379d785eb24}{m\_ii}},\mbox{\hyperlink{classRayBenConvection_a3f18799795eb3b79188f14aeed0c427b}{m\_jj}})}
\DoxyCodeLine{916                     + vn.block(2,1,\mbox{\hyperlink{classRayBenConvection_ad5d8335e885b5f4d0860b379d785eb24}{m\_ii}},\mbox{\hyperlink{classRayBenConvection_a3f18799795eb3b79188f14aeed0c427b}{m\_jj}})).array())).matrix();}
\DoxyCodeLine{917     \mbox{\hyperlink{classRayBenConvection_aeada1a30f797e981b52d3b4e0640b198}{m\_vhalf}}.block(1,2,\mbox{\hyperlink{classRayBenConvection_ad5d8335e885b5f4d0860b379d785eb24}{m\_ii}},\mbox{\hyperlink{classRayBenConvection_a3f18799795eb3b79188f14aeed0c427b}{m\_jj}}) = (0.5 * (vn.block(1,3,\mbox{\hyperlink{classRayBenConvection_ad5d8335e885b5f4d0860b379d785eb24}{m\_ii}},\mbox{\hyperlink{classRayBenConvection_a3f18799795eb3b79188f14aeed0c427b}{m\_jj}}) + vn.block(1,1,\mbox{\hyperlink{classRayBenConvection_ad5d8335e885b5f4d0860b379d785eb24}{m\_ii}},\mbox{\hyperlink{classRayBenConvection_a3f18799795eb3b79188f14aeed0c427b}{m\_jj}})).array() -\/ (\mbox{\hyperlink{classRayBenConvection_ae106f4c67cc111c54d23730e8e7fa7e6}{m\_dt}} / \mbox{\hyperlink{classRayBenConvection_a2bb417e336a4ae74e517e2eba04d179d}{m\_dx}} / 8)}
\DoxyCodeLine{918                     * ((un.block(2,1,\mbox{\hyperlink{classRayBenConvection_ad5d8335e885b5f4d0860b379d785eb24}{m\_ii}},\mbox{\hyperlink{classRayBenConvection_a3f18799795eb3b79188f14aeed0c427b}{m\_jj}}) + un.block(2,2,\mbox{\hyperlink{classRayBenConvection_ad5d8335e885b5f4d0860b379d785eb24}{m\_ii}},\mbox{\hyperlink{classRayBenConvection_a3f18799795eb3b79188f14aeed0c427b}{m\_jj}})).array() * (vn.block(1,2,\mbox{\hyperlink{classRayBenConvection_ad5d8335e885b5f4d0860b379d785eb24}{m\_ii}},\mbox{\hyperlink{classRayBenConvection_a3f18799795eb3b79188f14aeed0c427b}{m\_jj}}) }
\DoxyCodeLine{919                     + vn.block(2,2,\mbox{\hyperlink{classRayBenConvection_ad5d8335e885b5f4d0860b379d785eb24}{m\_ii}},\mbox{\hyperlink{classRayBenConvection_a3f18799795eb3b79188f14aeed0c427b}{m\_jj}})).array() -\/ (un.block(1,1,\mbox{\hyperlink{classRayBenConvection_ad5d8335e885b5f4d0860b379d785eb24}{m\_ii}},\mbox{\hyperlink{classRayBenConvection_a3f18799795eb3b79188f14aeed0c427b}{m\_jj}}) + un.block(1,0,\mbox{\hyperlink{classRayBenConvection_ad5d8335e885b5f4d0860b379d785eb24}{m\_ii}},\mbox{\hyperlink{classRayBenConvection_a3f18799795eb3b79188f14aeed0c427b}{m\_jj}})).array()}
\DoxyCodeLine{920                     * (vn.block(1,2,\mbox{\hyperlink{classRayBenConvection_ad5d8335e885b5f4d0860b379d785eb24}{m\_ii}},\mbox{\hyperlink{classRayBenConvection_a3f18799795eb3b79188f14aeed0c427b}{m\_jj}})}
\DoxyCodeLine{921                     + vn.block(0,2,\mbox{\hyperlink{classRayBenConvection_ad5d8335e885b5f4d0860b379d785eb24}{m\_ii}},\mbox{\hyperlink{classRayBenConvection_a3f18799795eb3b79188f14aeed0c427b}{m\_jj}})).array()) -\/ (\mbox{\hyperlink{classRayBenConvection_ae106f4c67cc111c54d23730e8e7fa7e6}{m\_dt}} / \mbox{\hyperlink{classRayBenConvection_a6d70b64b68c44a8b5f4ed5ca86dfcf71}{m\_dy}} / 8) * ((vn.block(1,3,\mbox{\hyperlink{classRayBenConvection_ad5d8335e885b5f4d0860b379d785eb24}{m\_ii}},\mbox{\hyperlink{classRayBenConvection_a3f18799795eb3b79188f14aeed0c427b}{m\_jj}}) }
\DoxyCodeLine{922                     + vn.block(1,2,\mbox{\hyperlink{classRayBenConvection_ad5d8335e885b5f4d0860b379d785eb24}{m\_ii}},\mbox{\hyperlink{classRayBenConvection_a3f18799795eb3b79188f14aeed0c427b}{m\_jj}})).array().square() -\/ (vn.block(1,2,\mbox{\hyperlink{classRayBenConvection_ad5d8335e885b5f4d0860b379d785eb24}{m\_ii}},\mbox{\hyperlink{classRayBenConvection_a3f18799795eb3b79188f14aeed0c427b}{m\_jj}})}
\DoxyCodeLine{923                     + vn.block(1,1,\mbox{\hyperlink{classRayBenConvection_ad5d8335e885b5f4d0860b379d785eb24}{m\_ii}},\mbox{\hyperlink{classRayBenConvection_a3f18799795eb3b79188f14aeed0c427b}{m\_jj}})).array().square())).matrix();}
\DoxyCodeLine{924     \textcolor{comment}{//\%Corrector step(Leapfrog)}}
\DoxyCodeLine{925     \mbox{\hyperlink{classRayBenConvection_a316a9e7f0c079b6fba771d7b15bd6647}{m\_uconv}}.block(2,1,\mbox{\hyperlink{classRayBenConvection_ad5d8335e885b5f4d0860b379d785eb24}{m\_ii}},\mbox{\hyperlink{classRayBenConvection_a3f18799795eb3b79188f14aeed0c427b}{m\_jj}}) = (un.block(2,1,\mbox{\hyperlink{classRayBenConvection_ad5d8335e885b5f4d0860b379d785eb24}{m\_ii}},\mbox{\hyperlink{classRayBenConvection_a3f18799795eb3b79188f14aeed0c427b}{m\_jj}}).array() -\/ (\mbox{\hyperlink{classRayBenConvection_ae106f4c67cc111c54d23730e8e7fa7e6}{m\_dt}} / (4 * \mbox{\hyperlink{classRayBenConvection_a2bb417e336a4ae74e517e2eba04d179d}{m\_dx}})) * ((\mbox{\hyperlink{classRayBenConvection_ab1204d12009f19080daa8e48072854cd}{m\_uhalf}}.block(3,1,\mbox{\hyperlink{classRayBenConvection_ad5d8335e885b5f4d0860b379d785eb24}{m\_ii}},\mbox{\hyperlink{classRayBenConvection_a3f18799795eb3b79188f14aeed0c427b}{m\_jj}}) }
\DoxyCodeLine{926                     + \mbox{\hyperlink{classRayBenConvection_ab1204d12009f19080daa8e48072854cd}{m\_uhalf}}.block(2,1,\mbox{\hyperlink{classRayBenConvection_ad5d8335e885b5f4d0860b379d785eb24}{m\_ii}},\mbox{\hyperlink{classRayBenConvection_a3f18799795eb3b79188f14aeed0c427b}{m\_jj}})).array().square() -\/ (\mbox{\hyperlink{classRayBenConvection_ab1204d12009f19080daa8e48072854cd}{m\_uhalf}}.block(2,1,\mbox{\hyperlink{classRayBenConvection_ad5d8335e885b5f4d0860b379d785eb24}{m\_ii}},\mbox{\hyperlink{classRayBenConvection_a3f18799795eb3b79188f14aeed0c427b}{m\_jj}})}
\DoxyCodeLine{927                     + \mbox{\hyperlink{classRayBenConvection_ab1204d12009f19080daa8e48072854cd}{m\_uhalf}}.block(1,1,\mbox{\hyperlink{classRayBenConvection_ad5d8335e885b5f4d0860b379d785eb24}{m\_ii}},\mbox{\hyperlink{classRayBenConvection_a3f18799795eb3b79188f14aeed0c427b}{m\_jj}})).array().square()) -\/ (\mbox{\hyperlink{classRayBenConvection_ae106f4c67cc111c54d23730e8e7fa7e6}{m\_dt}} / (4 * \mbox{\hyperlink{classRayBenConvection_a6d70b64b68c44a8b5f4ed5ca86dfcf71}{m\_dy}})) * ((\mbox{\hyperlink{classRayBenConvection_ab1204d12009f19080daa8e48072854cd}{m\_uhalf}}.block(2,1,\mbox{\hyperlink{classRayBenConvection_ad5d8335e885b5f4d0860b379d785eb24}{m\_ii}},\mbox{\hyperlink{classRayBenConvection_a3f18799795eb3b79188f14aeed0c427b}{m\_jj}}) }
\DoxyCodeLine{928                     + \mbox{\hyperlink{classRayBenConvection_ab1204d12009f19080daa8e48072854cd}{m\_uhalf}}.block(2,2,\mbox{\hyperlink{classRayBenConvection_ad5d8335e885b5f4d0860b379d785eb24}{m\_ii}},\mbox{\hyperlink{classRayBenConvection_a3f18799795eb3b79188f14aeed0c427b}{m\_jj}})).array() * (\mbox{\hyperlink{classRayBenConvection_aeada1a30f797e981b52d3b4e0640b198}{m\_vhalf}}.block(1,2,\mbox{\hyperlink{classRayBenConvection_ad5d8335e885b5f4d0860b379d785eb24}{m\_ii}},\mbox{\hyperlink{classRayBenConvection_a3f18799795eb3b79188f14aeed0c427b}{m\_jj}}) + \mbox{\hyperlink{classRayBenConvection_aeada1a30f797e981b52d3b4e0640b198}{m\_vhalf}}.block(2,2,\mbox{\hyperlink{classRayBenConvection_ad5d8335e885b5f4d0860b379d785eb24}{m\_ii}},\mbox{\hyperlink{classRayBenConvection_a3f18799795eb3b79188f14aeed0c427b}{m\_jj}})).array()}
\DoxyCodeLine{929                     -\/ (\mbox{\hyperlink{classRayBenConvection_ab1204d12009f19080daa8e48072854cd}{m\_uhalf}}.block(2,1,\mbox{\hyperlink{classRayBenConvection_ad5d8335e885b5f4d0860b379d785eb24}{m\_ii}},\mbox{\hyperlink{classRayBenConvection_a3f18799795eb3b79188f14aeed0c427b}{m\_jj}}) + \mbox{\hyperlink{classRayBenConvection_ab1204d12009f19080daa8e48072854cd}{m\_uhalf}}.block(2,0,\mbox{\hyperlink{classRayBenConvection_ad5d8335e885b5f4d0860b379d785eb24}{m\_ii}},\mbox{\hyperlink{classRayBenConvection_a3f18799795eb3b79188f14aeed0c427b}{m\_jj}})).array() * (\mbox{\hyperlink{classRayBenConvection_aeada1a30f797e981b52d3b4e0640b198}{m\_vhalf}}.block(1,1,\mbox{\hyperlink{classRayBenConvection_ad5d8335e885b5f4d0860b379d785eb24}{m\_ii}},\mbox{\hyperlink{classRayBenConvection_a3f18799795eb3b79188f14aeed0c427b}{m\_jj}}) }
\DoxyCodeLine{930                     + \mbox{\hyperlink{classRayBenConvection_aeada1a30f797e981b52d3b4e0640b198}{m\_vhalf}}.block(2,1,\mbox{\hyperlink{classRayBenConvection_ad5d8335e885b5f4d0860b379d785eb24}{m\_ii}},\mbox{\hyperlink{classRayBenConvection_a3f18799795eb3b79188f14aeed0c427b}{m\_jj}})).array())).matrix();}
\DoxyCodeLine{931     \mbox{\hyperlink{classRayBenConvection_a2e5088ea41b7faad0bcc9bfda83939ef}{m\_vconv}}.block(1,2,\mbox{\hyperlink{classRayBenConvection_ad5d8335e885b5f4d0860b379d785eb24}{m\_ii}},\mbox{\hyperlink{classRayBenConvection_a3f18799795eb3b79188f14aeed0c427b}{m\_jj}}) = (vn.block(1,2,\mbox{\hyperlink{classRayBenConvection_ad5d8335e885b5f4d0860b379d785eb24}{m\_ii}},\mbox{\hyperlink{classRayBenConvection_a3f18799795eb3b79188f14aeed0c427b}{m\_jj}}).array() -\/ (\mbox{\hyperlink{classRayBenConvection_ae106f4c67cc111c54d23730e8e7fa7e6}{m\_dt}} / (4 * \mbox{\hyperlink{classRayBenConvection_a2bb417e336a4ae74e517e2eba04d179d}{m\_dx}})) * ((\mbox{\hyperlink{classRayBenConvection_ab1204d12009f19080daa8e48072854cd}{m\_uhalf}}.block(2,1,\mbox{\hyperlink{classRayBenConvection_ad5d8335e885b5f4d0860b379d785eb24}{m\_ii}},\mbox{\hyperlink{classRayBenConvection_a3f18799795eb3b79188f14aeed0c427b}{m\_jj}}) }
\DoxyCodeLine{932                     + \mbox{\hyperlink{classRayBenConvection_ab1204d12009f19080daa8e48072854cd}{m\_uhalf}}.block(2,2,\mbox{\hyperlink{classRayBenConvection_ad5d8335e885b5f4d0860b379d785eb24}{m\_ii}},\mbox{\hyperlink{classRayBenConvection_a3f18799795eb3b79188f14aeed0c427b}{m\_jj}})).array() * (\mbox{\hyperlink{classRayBenConvection_aeada1a30f797e981b52d3b4e0640b198}{m\_vhalf}}.block(1,2,\mbox{\hyperlink{classRayBenConvection_ad5d8335e885b5f4d0860b379d785eb24}{m\_ii}},\mbox{\hyperlink{classRayBenConvection_a3f18799795eb3b79188f14aeed0c427b}{m\_jj}}) + \mbox{\hyperlink{classRayBenConvection_aeada1a30f797e981b52d3b4e0640b198}{m\_vhalf}}.block(2,2,\mbox{\hyperlink{classRayBenConvection_ad5d8335e885b5f4d0860b379d785eb24}{m\_ii}},\mbox{\hyperlink{classRayBenConvection_a3f18799795eb3b79188f14aeed0c427b}{m\_jj}})).array()}
\DoxyCodeLine{933                     -\/ (\mbox{\hyperlink{classRayBenConvection_ab1204d12009f19080daa8e48072854cd}{m\_uhalf}}.block(1,1,\mbox{\hyperlink{classRayBenConvection_ad5d8335e885b5f4d0860b379d785eb24}{m\_ii}},\mbox{\hyperlink{classRayBenConvection_a3f18799795eb3b79188f14aeed0c427b}{m\_jj}}) + \mbox{\hyperlink{classRayBenConvection_ab1204d12009f19080daa8e48072854cd}{m\_uhalf}}.block(1,0,\mbox{\hyperlink{classRayBenConvection_ad5d8335e885b5f4d0860b379d785eb24}{m\_ii}},\mbox{\hyperlink{classRayBenConvection_a3f18799795eb3b79188f14aeed0c427b}{m\_jj}})).array() * (\mbox{\hyperlink{classRayBenConvection_aeada1a30f797e981b52d3b4e0640b198}{m\_vhalf}}.block(1,2,\mbox{\hyperlink{classRayBenConvection_ad5d8335e885b5f4d0860b379d785eb24}{m\_ii}},\mbox{\hyperlink{classRayBenConvection_a3f18799795eb3b79188f14aeed0c427b}{m\_jj}})}
\DoxyCodeLine{934                     + \mbox{\hyperlink{classRayBenConvection_aeada1a30f797e981b52d3b4e0640b198}{m\_vhalf}}.block(0,2,\mbox{\hyperlink{classRayBenConvection_ad5d8335e885b5f4d0860b379d785eb24}{m\_ii}},\mbox{\hyperlink{classRayBenConvection_a3f18799795eb3b79188f14aeed0c427b}{m\_jj}})).array()) -\/ (\mbox{\hyperlink{classRayBenConvection_ae106f4c67cc111c54d23730e8e7fa7e6}{m\_dt}} / (4 * \mbox{\hyperlink{classRayBenConvection_a6d70b64b68c44a8b5f4ed5ca86dfcf71}{m\_dy}})) * ((\mbox{\hyperlink{classRayBenConvection_aeada1a30f797e981b52d3b4e0640b198}{m\_vhalf}}.block(1,3,\mbox{\hyperlink{classRayBenConvection_ad5d8335e885b5f4d0860b379d785eb24}{m\_ii}},\mbox{\hyperlink{classRayBenConvection_a3f18799795eb3b79188f14aeed0c427b}{m\_jj}})}
\DoxyCodeLine{935                     + \mbox{\hyperlink{classRayBenConvection_aeada1a30f797e981b52d3b4e0640b198}{m\_vhalf}}.block(1,2,\mbox{\hyperlink{classRayBenConvection_ad5d8335e885b5f4d0860b379d785eb24}{m\_ii}},\mbox{\hyperlink{classRayBenConvection_a3f18799795eb3b79188f14aeed0c427b}{m\_jj}})).array().square() }
\DoxyCodeLine{936                     -\/ (\mbox{\hyperlink{classRayBenConvection_aeada1a30f797e981b52d3b4e0640b198}{m\_vhalf}}.block(1,2,\mbox{\hyperlink{classRayBenConvection_ad5d8335e885b5f4d0860b379d785eb24}{m\_ii}},\mbox{\hyperlink{classRayBenConvection_a3f18799795eb3b79188f14aeed0c427b}{m\_jj}}) + \mbox{\hyperlink{classRayBenConvection_aeada1a30f797e981b52d3b4e0640b198}{m\_vhalf}}.block(1,1,\mbox{\hyperlink{classRayBenConvection_ad5d8335e885b5f4d0860b379d785eb24}{m\_ii}},\mbox{\hyperlink{classRayBenConvection_a3f18799795eb3b79188f14aeed0c427b}{m\_jj}})).array().square())).matrix();}
\DoxyCodeLine{937     \textcolor{comment}{//\%Buoyancy term (Boussinesq aproximation):}}
\DoxyCodeLine{938     \mbox{\hyperlink{classRayBenConvection_a2e5088ea41b7faad0bcc9bfda83939ef}{m\_vconv}}.block(1,2,\mbox{\hyperlink{classRayBenConvection_ad5d8335e885b5f4d0860b379d785eb24}{m\_ii}},\mbox{\hyperlink{classRayBenConvection_a3f18799795eb3b79188f14aeed0c427b}{m\_jj}}) = \mbox{\hyperlink{classRayBenConvection_a2e5088ea41b7faad0bcc9bfda83939ef}{m\_vconv}}.block(1,2,\mbox{\hyperlink{classRayBenConvection_ad5d8335e885b5f4d0860b379d785eb24}{m\_ii}},\mbox{\hyperlink{classRayBenConvection_a3f18799795eb3b79188f14aeed0c427b}{m\_jj}}) + (m\_Gr / std::pow(\mbox{\hyperlink{classRayBenConvection_a9558a662a91ef2887302e7f8913654b9}{m\_Re}}, 2)) * (0.5 * (\mbox{\hyperlink{classRayBenConvection_aecfd1a81f7bc8e559a3d17237ebf227c}{m\_T}}.block(1,1,\mbox{\hyperlink{classRayBenConvection_ad5d8335e885b5f4d0860b379d785eb24}{m\_ii}},\mbox{\hyperlink{classRayBenConvection_a3f18799795eb3b79188f14aeed0c427b}{m\_jj}})}
\DoxyCodeLine{939                     + \mbox{\hyperlink{classRayBenConvection_aecfd1a81f7bc8e559a3d17237ebf227c}{m\_T}}.block(1,2,\mbox{\hyperlink{classRayBenConvection_ad5d8335e885b5f4d0860b379d785eb24}{m\_ii}},\mbox{\hyperlink{classRayBenConvection_a3f18799795eb3b79188f14aeed0c427b}{m\_jj}})) -\/ Eigen::Matrix<double, m\_ii, m\_jj>::Constant(\mbox{\hyperlink{classRayBenConvection_abfa7478fe1bf2a2744403d17ca248a3d}{m\_To}}));}
\DoxyCodeLine{940 }
\DoxyCodeLine{941     \textcolor{comment}{//\%(2) Implicit central difference (spatial)}}
\DoxyCodeLine{942     Eigen::Matrix<double, -\/1, 1> U;}
\DoxyCodeLine{943     U.resize(\mbox{\hyperlink{classRayBenConvection_ab25ed57d64bce95a1f0b385151be1a41}{m\_bcu}}.rows()*\mbox{\hyperlink{classRayBenConvection_ab25ed57d64bce95a1f0b385151be1a41}{m\_bcu}}.cols(), 1);}
\DoxyCodeLine{944 }
\DoxyCodeLine{945     U.col(0) = (\mbox{\hyperlink{classRayBenConvection_a316a9e7f0c079b6fba771d7b15bd6647}{m\_uconv}}.block(1,1,\mbox{\hyperlink{classRayBenConvection_a316a9e7f0c079b6fba771d7b15bd6647}{m\_uconv}}.rows()-\/2,\mbox{\hyperlink{classRayBenConvection_a316a9e7f0c079b6fba771d7b15bd6647}{m\_uconv}}.cols()-\/2) + \mbox{\hyperlink{classRayBenConvection_ab25ed57d64bce95a1f0b385151be1a41}{m\_bcu}}).reshaped(\mbox{\hyperlink{classRayBenConvection_ab25ed57d64bce95a1f0b385151be1a41}{m\_bcu}}.rows()*\mbox{\hyperlink{classRayBenConvection_ab25ed57d64bce95a1f0b385151be1a41}{m\_bcu}}.cols(), 1);}
\DoxyCodeLine{946 }
\DoxyCodeLine{947     Eigen::Matrix<double, -\/1, 1> V;}
\DoxyCodeLine{948     V.resize(\mbox{\hyperlink{classRayBenConvection_ae8a99eaf006353101cd1cb4cd6803da4}{m\_bcv}}.rows()*\mbox{\hyperlink{classRayBenConvection_ae8a99eaf006353101cd1cb4cd6803da4}{m\_bcv}}.cols(), 1);}
\DoxyCodeLine{949 }
\DoxyCodeLine{950     V.col(0) = (\mbox{\hyperlink{classRayBenConvection_a2e5088ea41b7faad0bcc9bfda83939ef}{m\_vconv}}.block(1,1,\mbox{\hyperlink{classRayBenConvection_a2e5088ea41b7faad0bcc9bfda83939ef}{m\_vconv}}.rows()-\/2,\mbox{\hyperlink{classRayBenConvection_a2e5088ea41b7faad0bcc9bfda83939ef}{m\_vconv}}.cols()-\/2) + \mbox{\hyperlink{classRayBenConvection_ae8a99eaf006353101cd1cb4cd6803da4}{m\_bcv}}).reshaped(\mbox{\hyperlink{classRayBenConvection_ae8a99eaf006353101cd1cb4cd6803da4}{m\_bcv}}.rows()*\mbox{\hyperlink{classRayBenConvection_ae8a99eaf006353101cd1cb4cd6803da4}{m\_bcv}}.cols(), 1);}
\DoxyCodeLine{951 }
\DoxyCodeLine{952     std::thread t1(\mbox{\hyperlink{classRayBenConvection_a103559797e2c0013967de38b22af97f2}{m\_d\_solve}}, std::ref(U), std::ref(\mbox{\hyperlink{classRayBenConvection_ae3f0ffb3cfe0c04d2ad97caa1b66657d}{m\_pu}}), std::ref(\mbox{\hyperlink{classRayBenConvection_aaf54f2309f7ac98e9f2cc449eae6bd37}{m\_Lu\_solver}}), std::ref(\mbox{\hyperlink{classRayBenConvection_abc851be2138ae32b40834060bffe5a69}{m\_Uu\_solver}}));}
\DoxyCodeLine{953     std::thread t2(\mbox{\hyperlink{classRayBenConvection_a103559797e2c0013967de38b22af97f2}{m\_d\_solve}}, std::ref(V), std::ref(\mbox{\hyperlink{classRayBenConvection_aa052588ce5527b7315207f19504843c5}{m\_pv}}), std::ref(\mbox{\hyperlink{classRayBenConvection_ab7a3c25d7d180499643a96b52c376ef8}{m\_Lv\_solver}}), std::ref(\mbox{\hyperlink{classRayBenConvection_a41024c3b9faa8588e3ecd679203b2e4c}{m\_Uv\_solver}}));}
\DoxyCodeLine{954 }
\DoxyCodeLine{955     t1.join();}
\DoxyCodeLine{956     t2.join();}
\DoxyCodeLine{957 }
\DoxyCodeLine{958     Eigen::Matrix<double, -\/1, -\/1> new\_U = U.reshaped(\mbox{\hyperlink{classRayBenConvection_a00ece8699bc4531e4dc5edfe2cfcfd7b}{m\_nx}}-\/1, \mbox{\hyperlink{classRayBenConvection_aa2e29e985716895f8f19e3930078ec00}{m\_ny}}-\/2);}
\DoxyCodeLine{959 }
\DoxyCodeLine{960     \mbox{\hyperlink{classRayBenConvection_a22bceb43d4d9ba695f21bf1306a8f354}{m\_ustar}}.block(1,1,\mbox{\hyperlink{classRayBenConvection_a22bceb43d4d9ba695f21bf1306a8f354}{m\_ustar}}.rows()-\/2,\mbox{\hyperlink{classRayBenConvection_a22bceb43d4d9ba695f21bf1306a8f354}{m\_ustar}}.cols()-\/2) = new\_U;}
\DoxyCodeLine{961 }
\DoxyCodeLine{962     Eigen::Matrix<double, -\/1, -\/1> new\_V = V.reshaped(\mbox{\hyperlink{classRayBenConvection_a00ece8699bc4531e4dc5edfe2cfcfd7b}{m\_nx}}-\/2, \mbox{\hyperlink{classRayBenConvection_aa2e29e985716895f8f19e3930078ec00}{m\_ny}}-\/1);}
\DoxyCodeLine{963 }
\DoxyCodeLine{964     \mbox{\hyperlink{classRayBenConvection_a8e8d1bec9c3fbd2876adc957f4ed767d}{m\_vstar}}.block(1,1,\mbox{\hyperlink{classRayBenConvection_a8e8d1bec9c3fbd2876adc957f4ed767d}{m\_vstar}}.rows()-\/2,\mbox{\hyperlink{classRayBenConvection_a8e8d1bec9c3fbd2876adc957f4ed767d}{m\_vstar}}.cols()-\/2) = new\_V;}
\DoxyCodeLine{965 }
\DoxyCodeLine{966     \textcolor{comment}{//\%Pressure Poisson equation(elliptic):}}
\DoxyCodeLine{967     \mbox{\hyperlink{classRayBenConvection_a2bf183a03e99f6a9b2a6f4139f780ec3}{m\_S}}.block(1,1,\mbox{\hyperlink{classRayBenConvection_ad5d8335e885b5f4d0860b379d785eb24}{m\_ii}},\mbox{\hyperlink{classRayBenConvection_a3f18799795eb3b79188f14aeed0c427b}{m\_jj}}) = (\mbox{\hyperlink{classRayBenConvection_a22bceb43d4d9ba695f21bf1306a8f354}{m\_ustar}}.block(2,1,\mbox{\hyperlink{classRayBenConvection_ad5d8335e885b5f4d0860b379d785eb24}{m\_ii}},\mbox{\hyperlink{classRayBenConvection_a3f18799795eb3b79188f14aeed0c427b}{m\_jj}}) -\/ \mbox{\hyperlink{classRayBenConvection_a22bceb43d4d9ba695f21bf1306a8f354}{m\_ustar}}.block(1,1,\mbox{\hyperlink{classRayBenConvection_ad5d8335e885b5f4d0860b379d785eb24}{m\_ii}},\mbox{\hyperlink{classRayBenConvection_a3f18799795eb3b79188f14aeed0c427b}{m\_jj}})) / \mbox{\hyperlink{classRayBenConvection_a2bb417e336a4ae74e517e2eba04d179d}{m\_dx}}}
\DoxyCodeLine{968                             + (\mbox{\hyperlink{classRayBenConvection_a8e8d1bec9c3fbd2876adc957f4ed767d}{m\_vstar}}.block(1,2,\mbox{\hyperlink{classRayBenConvection_ad5d8335e885b5f4d0860b379d785eb24}{m\_ii}},\mbox{\hyperlink{classRayBenConvection_a3f18799795eb3b79188f14aeed0c427b}{m\_jj}}) -\/ \mbox{\hyperlink{classRayBenConvection_a8e8d1bec9c3fbd2876adc957f4ed767d}{m\_vstar}}.block(1,1,\mbox{\hyperlink{classRayBenConvection_ad5d8335e885b5f4d0860b379d785eb24}{m\_ii}},\mbox{\hyperlink{classRayBenConvection_a3f18799795eb3b79188f14aeed0c427b}{m\_jj}})) / \mbox{\hyperlink{classRayBenConvection_a6d70b64b68c44a8b5f4ed5ca86dfcf71}{m\_dy}};}
\DoxyCodeLine{969 }
\DoxyCodeLine{970     Eigen::Matrix<double, -\/1, 1> s;}
\DoxyCodeLine{971     s.resize((\mbox{\hyperlink{classRayBenConvection_a2bf183a03e99f6a9b2a6f4139f780ec3}{m\_S}}.rows()-\/2)*(\mbox{\hyperlink{classRayBenConvection_a2bf183a03e99f6a9b2a6f4139f780ec3}{m\_S}}.cols()-\/2), 1);}
\DoxyCodeLine{972 }
\DoxyCodeLine{973     s.col(0) = \mbox{\hyperlink{classRayBenConvection_a2bf183a03e99f6a9b2a6f4139f780ec3}{m\_S}}.block(1,1,\mbox{\hyperlink{classRayBenConvection_a2bf183a03e99f6a9b2a6f4139f780ec3}{m\_S}}.rows()-\/2,\mbox{\hyperlink{classRayBenConvection_a2bf183a03e99f6a9b2a6f4139f780ec3}{m\_S}}.cols()-\/2).reshaped((\mbox{\hyperlink{classRayBenConvection_a2bf183a03e99f6a9b2a6f4139f780ec3}{m\_S}}.rows()-\/2)*(\mbox{\hyperlink{classRayBenConvection_a2bf183a03e99f6a9b2a6f4139f780ec3}{m\_S}}.cols()-\/2), 1);}
\DoxyCodeLine{974 }
\DoxyCodeLine{975     s(\mbox{\hyperlink{classRayBenConvection_a1feee928e15de6738a5c468fc10ab263}{m\_pp}}) = \textcolor{keyword}{static\_cast<}Eigen::Matrix<\textcolor{keywordtype}{double}, -\/1, -\/1\textcolor{keyword}{>}>(\mbox{\hyperlink{classRayBenConvection_ad38e2b16fa2e62e025fdcf2951266761}{m\_Up\_solver}}.solve(\mbox{\hyperlink{classRayBenConvection_a6287ec3344a639bccc0ae10bb04aa900}{m\_Lp\_solver}}.solve(s(\mbox{\hyperlink{classRayBenConvection_a1feee928e15de6738a5c468fc10ab263}{m\_pp}}))));}
\DoxyCodeLine{976 }
\DoxyCodeLine{977     Eigen::Matrix<double, -\/1, -\/1> new\_s = s.reshaped(\mbox{\hyperlink{classRayBenConvection_a00ece8699bc4531e4dc5edfe2cfcfd7b}{m\_nx}}-\/2, \mbox{\hyperlink{classRayBenConvection_aa2e29e985716895f8f19e3930078ec00}{m\_ny}}-\/2);}
\DoxyCodeLine{978 }
\DoxyCodeLine{979     \mbox{\hyperlink{classRayBenConvection_a66828b8a9611c0a5dac1eeb64d1fa614}{m\_p}}.block(1,1,new\_s.rows(),new\_s.cols()) = new\_s;}
\DoxyCodeLine{980 }
\DoxyCodeLine{981     \mbox{\hyperlink{classRayBenConvection_a66828b8a9611c0a5dac1eeb64d1fa614}{m\_p}}.row(0) = \mbox{\hyperlink{classRayBenConvection_a66828b8a9611c0a5dac1eeb64d1fa614}{m\_p}}.row(1);}
\DoxyCodeLine{982     \mbox{\hyperlink{classRayBenConvection_a66828b8a9611c0a5dac1eeb64d1fa614}{m\_p}}.row(\mbox{\hyperlink{classRayBenConvection_a66828b8a9611c0a5dac1eeb64d1fa614}{m\_p}}.rows()-\/1) = \mbox{\hyperlink{classRayBenConvection_a66828b8a9611c0a5dac1eeb64d1fa614}{m\_p}}.row(\mbox{\hyperlink{classRayBenConvection_a66828b8a9611c0a5dac1eeb64d1fa614}{m\_p}}.rows()-\/2);}
\DoxyCodeLine{983 }
\DoxyCodeLine{984     \mbox{\hyperlink{classRayBenConvection_a66828b8a9611c0a5dac1eeb64d1fa614}{m\_p}}.col(0) = \mbox{\hyperlink{classRayBenConvection_a66828b8a9611c0a5dac1eeb64d1fa614}{m\_p}}.col(1);}
\DoxyCodeLine{985     \mbox{\hyperlink{classRayBenConvection_a66828b8a9611c0a5dac1eeb64d1fa614}{m\_p}}.col(\mbox{\hyperlink{classRayBenConvection_a66828b8a9611c0a5dac1eeb64d1fa614}{m\_p}}.cols()-\/1) = \mbox{\hyperlink{classRayBenConvection_a66828b8a9611c0a5dac1eeb64d1fa614}{m\_p}}.col(\mbox{\hyperlink{classRayBenConvection_a66828b8a9611c0a5dac1eeb64d1fa614}{m\_p}}.cols()-\/2);}
\DoxyCodeLine{986 }
\DoxyCodeLine{987     \mbox{\hyperlink{classRayBenConvection_ac9933db8381584f9d732b85391da2533}{m\_u}}.block(2,1,\mbox{\hyperlink{classRayBenConvection_ad5d8335e885b5f4d0860b379d785eb24}{m\_ii}},\mbox{\hyperlink{classRayBenConvection_a3f18799795eb3b79188f14aeed0c427b}{m\_jj}}) = \mbox{\hyperlink{classRayBenConvection_a22bceb43d4d9ba695f21bf1306a8f354}{m\_ustar}}.block(2,1,\mbox{\hyperlink{classRayBenConvection_ad5d8335e885b5f4d0860b379d785eb24}{m\_ii}},\mbox{\hyperlink{classRayBenConvection_a3f18799795eb3b79188f14aeed0c427b}{m\_jj}}) -\/ (\mbox{\hyperlink{classRayBenConvection_a66828b8a9611c0a5dac1eeb64d1fa614}{m\_p}}.block(2,1,\mbox{\hyperlink{classRayBenConvection_ad5d8335e885b5f4d0860b379d785eb24}{m\_ii}},\mbox{\hyperlink{classRayBenConvection_a3f18799795eb3b79188f14aeed0c427b}{m\_jj}}) -\/ \mbox{\hyperlink{classRayBenConvection_a66828b8a9611c0a5dac1eeb64d1fa614}{m\_p}}.block(1,1,\mbox{\hyperlink{classRayBenConvection_ad5d8335e885b5f4d0860b379d785eb24}{m\_ii}},\mbox{\hyperlink{classRayBenConvection_a3f18799795eb3b79188f14aeed0c427b}{m\_jj}})) / \mbox{\hyperlink{classRayBenConvection_a2bb417e336a4ae74e517e2eba04d179d}{m\_dx}};}
\DoxyCodeLine{988     \mbox{\hyperlink{classRayBenConvection_af863193c10cffeaf20f749df0ec845a5}{m\_v}}.block(1,2,\mbox{\hyperlink{classRayBenConvection_ad5d8335e885b5f4d0860b379d785eb24}{m\_ii}},\mbox{\hyperlink{classRayBenConvection_a3f18799795eb3b79188f14aeed0c427b}{m\_jj}}) = \mbox{\hyperlink{classRayBenConvection_a8e8d1bec9c3fbd2876adc957f4ed767d}{m\_vstar}}.block(1,2,\mbox{\hyperlink{classRayBenConvection_ad5d8335e885b5f4d0860b379d785eb24}{m\_ii}},\mbox{\hyperlink{classRayBenConvection_a3f18799795eb3b79188f14aeed0c427b}{m\_jj}}) -\/ (\mbox{\hyperlink{classRayBenConvection_a66828b8a9611c0a5dac1eeb64d1fa614}{m\_p}}.block(1,2,\mbox{\hyperlink{classRayBenConvection_ad5d8335e885b5f4d0860b379d785eb24}{m\_ii}},\mbox{\hyperlink{classRayBenConvection_a3f18799795eb3b79188f14aeed0c427b}{m\_jj}}) -\/ \mbox{\hyperlink{classRayBenConvection_a66828b8a9611c0a5dac1eeb64d1fa614}{m\_p}}.block(1,1,\mbox{\hyperlink{classRayBenConvection_ad5d8335e885b5f4d0860b379d785eb24}{m\_ii}},\mbox{\hyperlink{classRayBenConvection_a3f18799795eb3b79188f14aeed0c427b}{m\_jj}})) / \mbox{\hyperlink{classRayBenConvection_a6d70b64b68c44a8b5f4ed5ca86dfcf71}{m\_dy}};}
\DoxyCodeLine{989 }
\DoxyCodeLine{990     \mbox{\hyperlink{classRayBenConvection_ac9933db8381584f9d732b85391da2533}{m\_u}}.row(0) = Eigen::Matrix<double, 1, m\_ny>::Constant(2*\mbox{\hyperlink{classRayBenConvection_a56534034d797d9099f53367d4828f0c7}{m\_UW}}) -\/ \mbox{\hyperlink{classRayBenConvection_ac9933db8381584f9d732b85391da2533}{m\_u}}.row(1);}
\DoxyCodeLine{991     \mbox{\hyperlink{classRayBenConvection_ac9933db8381584f9d732b85391da2533}{m\_u}}.row(\mbox{\hyperlink{classRayBenConvection_ac9933db8381584f9d732b85391da2533}{m\_u}}.rows()-\/1) = Eigen::Matrix<double, 1, m\_ny>::Constant(2*\mbox{\hyperlink{classRayBenConvection_ad3b4ec6a6500a9b9355c60d66a62091b}{m\_UE}}) -\/ \mbox{\hyperlink{classRayBenConvection_ac9933db8381584f9d732b85391da2533}{m\_u}}.row(\mbox{\hyperlink{classRayBenConvection_ac9933db8381584f9d732b85391da2533}{m\_u}}.rows()-\/2);}
\DoxyCodeLine{992 }
\DoxyCodeLine{993     \mbox{\hyperlink{classRayBenConvection_ac9933db8381584f9d732b85391da2533}{m\_u}}.col(0).setConstant(\mbox{\hyperlink{classRayBenConvection_a99f0d9ab29a2db33829175a790fa9bc7}{m\_US}});}
\DoxyCodeLine{994     \mbox{\hyperlink{classRayBenConvection_ac9933db8381584f9d732b85391da2533}{m\_u}}.col(\mbox{\hyperlink{classRayBenConvection_ac9933db8381584f9d732b85391da2533}{m\_u}}.cols()-\/1).setConstant(\mbox{\hyperlink{classRayBenConvection_aab15fee9f0b6d470dd9d02d85439a7a8}{m\_UN}});}
\DoxyCodeLine{995 }
\DoxyCodeLine{996     \mbox{\hyperlink{classRayBenConvection_af863193c10cffeaf20f749df0ec845a5}{m\_v}}.row(0).setConstant(\mbox{\hyperlink{classRayBenConvection_aee29299c3f2cf435a3d179d4dcd9b0a1}{m\_VW}});}
\DoxyCodeLine{997     \mbox{\hyperlink{classRayBenConvection_af863193c10cffeaf20f749df0ec845a5}{m\_v}}.row(\mbox{\hyperlink{classRayBenConvection_af863193c10cffeaf20f749df0ec845a5}{m\_v}}.rows()-\/1).setConstant(\mbox{\hyperlink{classRayBenConvection_abfccbde057005c07f8ee2b76ef68e4f7}{m\_VE}});}
\DoxyCodeLine{998 }
\DoxyCodeLine{999     \mbox{\hyperlink{classRayBenConvection_af863193c10cffeaf20f749df0ec845a5}{m\_v}}.col(0) = Eigen::Matrix<double, m\_nx, 1>::Constant(2*\mbox{\hyperlink{classRayBenConvection_afc0d1ada59367f173257a20e2cea845b}{m\_VS}}) -\/ \mbox{\hyperlink{classRayBenConvection_af863193c10cffeaf20f749df0ec845a5}{m\_v}}.col(1);}
\DoxyCodeLine{1000     \mbox{\hyperlink{classRayBenConvection_af863193c10cffeaf20f749df0ec845a5}{m\_v}}.col(\mbox{\hyperlink{classRayBenConvection_af863193c10cffeaf20f749df0ec845a5}{m\_v}}.cols()-\/1) = Eigen::Matrix<double, m\_nx, 1>::Constant(2*\mbox{\hyperlink{classRayBenConvection_ace7b32dda44cace25edfe8e481601733}{m\_VN}}) -\/ \mbox{\hyperlink{classRayBenConvection_af863193c10cffeaf20f749df0ec845a5}{m\_v}}.col(\mbox{\hyperlink{classRayBenConvection_af863193c10cffeaf20f749df0ec845a5}{m\_v}}.cols()-\/2);}
\DoxyCodeLine{1001 }
\DoxyCodeLine{1002   \}}
\DoxyCodeLine{1003 }
\DoxyCodeLine{1004 }
\DoxyCodeLine{1005   \textcolor{keywordflow}{if} (\mbox{\hyperlink{classRayBenConvection_af8611d2ad5bd585ec902c30895c8a916}{m\_it}} == \mbox{\hyperlink{classRayBenConvection_a30361d2ad21ab61d60fb8bb21fba82de}{m\_END\_CICLE}}) \{}
\DoxyCodeLine{1006     std::cerr << std::endl << \textcolor{stringliteral}{"{}INFO: RayBenConvection: eval\_next\_frame: "{}} }
\DoxyCodeLine{1007               << \textcolor{stringliteral}{"{}Simulation ended with no errors."{}} << std::endl;}
\DoxyCodeLine{1008     \mbox{\hyperlink{classRayBenConvection_a4922c04914255acd890452879eee7a8e}{simulation\_state}}.\mbox{\hyperlink{structRayBenConvection_1_1simulation__state__t_ade312d660fc2a60c05ea13f92b4ae736}{ended}} = \textcolor{keyword}{true};}
\DoxyCodeLine{1009     \textcolor{keywordflow}{return} \mbox{\hyperlink{classRayBenConvection_a4922c04914255acd890452879eee7a8e}{simulation\_state}};}
\DoxyCodeLine{1010   \}}
\DoxyCodeLine{1011 }
\DoxyCodeLine{1012 }
\DoxyCodeLine{1013   ++\mbox{\hyperlink{classRayBenConvection_af8611d2ad5bd585ec902c30895c8a916}{m\_it}};}
\DoxyCodeLine{1014 }
\DoxyCodeLine{1015   \mbox{\hyperlink{classRayBenConvection_a4922c04914255acd890452879eee7a8e}{simulation\_state}}.\mbox{\hyperlink{structRayBenConvection_1_1simulation__state__t_ade312d660fc2a60c05ea13f92b4ae736}{ended}} = \textcolor{keyword}{false};}
\DoxyCodeLine{1016   \textcolor{keywordflow}{return} \mbox{\hyperlink{classRayBenConvection_a4922c04914255acd890452879eee7a8e}{simulation\_state}};}
\DoxyCodeLine{1017 \}}
\DoxyCodeLine{1018 }
\DoxyCodeLine{1019 \textcolor{keywordtype}{void} RayBenConvection::write\_current\_data()\{}
\DoxyCodeLine{1020   \textcolor{keywordflow}{if} (\mbox{\hyperlink{classRayBenConvection_af8611d2ad5bd585ec902c30895c8a916}{m\_it}} == 0) \{}
\DoxyCodeLine{1021     \mbox{\hyperlink{classRayBenConvection_a1efa7e03cd0d72a7901f47dd575bfdc5}{m\_output\_header\_file}}.open(OUTPUT\_HEADER\_FILE\_NAME, std::ios\_base::out);}
\DoxyCodeLine{1022     std::cout << \textcolor{stringliteral}{"{}File aperto"{}}; }
\DoxyCodeLine{1023     \textcolor{keywordflow}{if} (! \mbox{\hyperlink{classRayBenConvection_a1efa7e03cd0d72a7901f47dd575bfdc5}{m\_output\_header\_file}}.is\_open())\{}
\DoxyCodeLine{1024       std::cerr <<\textcolor{stringliteral}{"{}Failed opening output\_header\_file. Exiting..."{}} <<std::endl;}
\DoxyCodeLine{1025       \textcolor{keywordflow}{return};}
\DoxyCodeLine{1026     \}}
\DoxyCodeLine{1027     \mbox{\hyperlink{classRayBenConvection_a1efa7e03cd0d72a7901f47dd575bfdc5}{m\_output\_header\_file}} << \textcolor{stringliteral}{"{}\#define NX "{}} << \mbox{\hyperlink{classRayBenConvection_a00ece8699bc4531e4dc5edfe2cfcfd7b}{m\_nx}} << \textcolor{stringliteral}{"{}\(\backslash\)n"{}} }
\DoxyCodeLine{1028                             \textcolor{stringliteral}{"{}\#define NY "{}} << \mbox{\hyperlink{classRayBenConvection_aa2e29e985716895f8f19e3930078ec00}{m\_ny}} << \textcolor{stringliteral}{"{}\(\backslash\)n"{}}}
\DoxyCodeLine{1029                             \textcolor{stringliteral}{"{}\#define N\_STEPS "{}} << \mbox{\hyperlink{classRayBenConvection_a30361d2ad21ab61d60fb8bb21fba82de}{m\_END\_CICLE}} << \textcolor{stringliteral}{"{}\(\backslash\)n"{}} }
\DoxyCodeLine{1030                             \textcolor{stringliteral}{"{}const double cold\_temp = "{}} << \mbox{\hyperlink{classRayBenConvection_a0fade52114cb600deba397e9c3d86b12}{m\_TN}} << \textcolor{stringliteral}{"{};\(\backslash\)n"{}}}
\DoxyCodeLine{1031                             \textcolor{stringliteral}{"{}const double hot\_temp = "{}} << \mbox{\hyperlink{classRayBenConvection_ac1331aa9a8a5f7b079af0df68bc3dcfc}{m\_TS}} << \textcolor{stringliteral}{"{};\(\backslash\)n"{}}}
\DoxyCodeLine{1032                             \textcolor{stringliteral}{"{}const double T [NX][NY][N\_STEPS] = \{\(\backslash\)n"{}};}
\DoxyCodeLine{1033     m\_write\_current\_frame();}
\DoxyCodeLine{1034   \}}
\DoxyCodeLine{1035   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (\mbox{\hyperlink{classRayBenConvection_af8611d2ad5bd585ec902c30895c8a916}{m\_it}} == \mbox{\hyperlink{classRayBenConvection_a30361d2ad21ab61d60fb8bb21fba82de}{m\_END\_CICLE}})\{}
\DoxyCodeLine{1036     \mbox{\hyperlink{classRayBenConvection_a1efa7e03cd0d72a7901f47dd575bfdc5}{m\_output\_header\_file}} << \textcolor{stringliteral}{"{}\}; "{}};}
\DoxyCodeLine{1037     \mbox{\hyperlink{classRayBenConvection_a1efa7e03cd0d72a7901f47dd575bfdc5}{m\_output\_header\_file}}.close();}
\DoxyCodeLine{1038   std::cout << \textcolor{stringliteral}{"{}File chiuso"{}};}
\DoxyCodeLine{1039   \}}
\DoxyCodeLine{1040   \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{1041     \mbox{\hyperlink{classRayBenConvection_a1efa7e03cd0d72a7901f47dd575bfdc5}{m\_output\_header\_file}} <<\textcolor{stringliteral}{"{},\(\backslash\)n"{}};}
\DoxyCodeLine{1042     m\_write\_current\_frame();}
\DoxyCodeLine{1043   \}}
\DoxyCodeLine{1044 \}}

\end{DoxyCode}
